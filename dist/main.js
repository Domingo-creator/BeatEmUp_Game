/*! For license information please see main.js.LICENSE.txt */
!function(){var e={766:function(e,t,i){var n;!function(){"use strict";var o=function(){this.init()};o.prototype={init:function(){var e=this||s;return e._counter=1e3,e._html5AudioPool=[],e.html5PoolSize=10,e._codecs={},e._howls=[],e._muted=!1,e._volume=1,e._canPlayEvent="canplaythrough",e._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,e.masterGain=null,e.noAudio=!1,e.usingWebAudio=!0,e.autoSuspend=!0,e.ctx=null,e.autoUnlock=!0,e._setup(),e},volume:function(e){var t=this||s;if(e=parseFloat(e),t.ctx||_(),void 0!==e&&e>=0&&e<=1){if(t._volume=e,t._muted)return t;t.usingWebAudio&&t.masterGain.gain.setValueAtTime(e,s.ctx.currentTime);for(var i=0;i<t._howls.length;i++)if(!t._howls[i]._webAudio)for(var n=t._howls[i]._getSoundIds(),o=0;o<n.length;o++){var r=t._howls[i]._soundById(n[o]);r&&r._node&&(r._node.volume=r._volume*e)}return t}return t._volume},mute:function(e){var t=this||s;t.ctx||_(),t._muted=e,t.usingWebAudio&&t.masterGain.gain.setValueAtTime(e?0:t._volume,s.ctx.currentTime);for(var i=0;i<t._howls.length;i++)if(!t._howls[i]._webAudio)for(var n=t._howls[i]._getSoundIds(),o=0;o<n.length;o++){var r=t._howls[i]._soundById(n[o]);r&&r._node&&(r._node.muted=!!e||r._muted)}return t},stop:function(){for(var e=this||s,t=0;t<e._howls.length;t++)e._howls[t].stop();return e},unload:function(){for(var e=this||s,t=e._howls.length-1;t>=0;t--)e._howls[t].unload();return e.usingWebAudio&&e.ctx&&void 0!==e.ctx.close&&(e.ctx.close(),e.ctx=null,_()),e},codecs:function(e){return(this||s)._codecs[e.replace(/^x-/,"")]},_setup:function(){var e=this||s;if(e.state=e.ctx&&e.ctx.state||"suspended",e._autoSuspend(),!e.usingWebAudio)if("undefined"!=typeof Audio)try{void 0===(new Audio).oncanplaythrough&&(e._canPlayEvent="canplay")}catch(t){e.noAudio=!0}else e.noAudio=!0;try{(new Audio).muted&&(e.noAudio=!0)}catch(e){}return e.noAudio||e._setupCodecs(),e},_setupCodecs:function(){var e=this||s,t=null;try{t="undefined"!=typeof Audio?new Audio:null}catch(t){return e}if(!t||"function"!=typeof t.canPlayType)return e;var i=t.canPlayType("audio/mpeg;").replace(/^no$/,""),n=e._navigator?e._navigator.userAgent:"",o=n.match(/OPR\/([0-6].)/g),r=o&&parseInt(o[0].split("/")[1],10)<33,a=-1!==n.indexOf("Safari")&&-1===n.indexOf("Chrome"),u=n.match(/Version\/(.*?) /),d=a&&u&&parseInt(u[1],10)<15;return e._codecs={mp3:!(r||!i&&!t.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!i,opus:!!t.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(t.canPlayType('audio/wav; codecs="1"')||t.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!t.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!t.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(t.canPlayType("audio/x-m4a;")||t.canPlayType("audio/m4a;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(t.canPlayType("audio/x-m4b;")||t.canPlayType("audio/m4b;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(t.canPlayType("audio/x-mp4;")||t.canPlayType("audio/mp4;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!(d||!t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!(d||!t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!t.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(t.canPlayType("audio/x-flac;")||t.canPlayType("audio/flac;")).replace(/^no$/,"")},e},_unlockAudio:function(){var e=this||s;if(!e._audioUnlocked&&e.ctx){e._audioUnlocked=!1,e.autoUnlock=!1,e._mobileUnloaded||44100===e.ctx.sampleRate||(e._mobileUnloaded=!0,e.unload()),e._scratchBuffer=e.ctx.createBuffer(1,1,22050);var t=function(i){for(;e._html5AudioPool.length<e.html5PoolSize;)try{var n=new Audio;n._unlocked=!0,e._releaseHtml5Audio(n)}catch(i){e.noAudio=!0;break}for(var o=0;o<e._howls.length;o++)if(!e._howls[o]._webAudio)for(var s=e._howls[o]._getSoundIds(),r=0;r<s.length;r++){var a=e._howls[o]._soundById(s[r]);a&&a._node&&!a._node._unlocked&&(a._node._unlocked=!0,a._node.load())}e._autoResume();var u=e.ctx.createBufferSource();u.buffer=e._scratchBuffer,u.connect(e.ctx.destination),void 0===u.start?u.noteOn(0):u.start(0),"function"==typeof e.ctx.resume&&e.ctx.resume(),u.onended=function(){u.disconnect(0),e._audioUnlocked=!0,document.removeEventListener("touchstart",t,!0),document.removeEventListener("touchend",t,!0),document.removeEventListener("click",t,!0),document.removeEventListener("keydown",t,!0);for(var i=0;i<e._howls.length;i++)e._howls[i]._emit("unlock")}};return document.addEventListener("touchstart",t,!0),document.addEventListener("touchend",t,!0),document.addEventListener("click",t,!0),document.addEventListener("keydown",t,!0),e}},_obtainHtml5Audio:function(){var e=this||s;if(e._html5AudioPool.length)return e._html5AudioPool.pop();var t=(new Audio).play();return t&&"undefined"!=typeof Promise&&(t instanceof Promise||"function"==typeof t.then)&&t.catch((function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")})),new Audio},_releaseHtml5Audio:function(e){var t=this||s;return e._unlocked&&t._html5AudioPool.push(e),t},_autoSuspend:function(){var e=this;if(e.autoSuspend&&e.ctx&&void 0!==e.ctx.suspend&&s.usingWebAudio){for(var t=0;t<e._howls.length;t++)if(e._howls[t]._webAudio)for(var i=0;i<e._howls[t]._sounds.length;i++)if(!e._howls[t]._sounds[i]._paused)return e;return e._suspendTimer&&clearTimeout(e._suspendTimer),e._suspendTimer=setTimeout((function(){if(e.autoSuspend){e._suspendTimer=null,e.state="suspending";var t=function(){e.state="suspended",e._resumeAfterSuspend&&(delete e._resumeAfterSuspend,e._autoResume())};e.ctx.suspend().then(t,t)}}),3e4),e}},_autoResume:function(){var e=this;if(e.ctx&&void 0!==e.ctx.resume&&s.usingWebAudio)return"running"===e.state&&"interrupted"!==e.ctx.state&&e._suspendTimer?(clearTimeout(e._suspendTimer),e._suspendTimer=null):"suspended"===e.state||"running"===e.state&&"interrupted"===e.ctx.state?(e.ctx.resume().then((function(){e.state="running";for(var t=0;t<e._howls.length;t++)e._howls[t]._emit("resume")})),e._suspendTimer&&(clearTimeout(e._suspendTimer),e._suspendTimer=null)):"suspending"===e.state&&(e._resumeAfterSuspend=!0),e}};var s=new o,r=function(e){e.src&&0!==e.src.length?this.init(e):console.error("An array of source files must be passed with any new Howl.")};r.prototype={init:function(e){var t=this;return s.ctx||_(),t._autoplay=e.autoplay||!1,t._format="string"!=typeof e.format?e.format:[e.format],t._html5=e.html5||!1,t._muted=e.mute||!1,t._loop=e.loop||!1,t._pool=e.pool||5,t._preload="boolean"!=typeof e.preload&&"metadata"!==e.preload||e.preload,t._rate=e.rate||1,t._sprite=e.sprite||{},t._src="string"!=typeof e.src?e.src:[e.src],t._volume=void 0!==e.volume?e.volume:1,t._xhr={method:e.xhr&&e.xhr.method?e.xhr.method:"GET",headers:e.xhr&&e.xhr.headers?e.xhr.headers:null,withCredentials:!(!e.xhr||!e.xhr.withCredentials)&&e.xhr.withCredentials},t._duration=0,t._state="unloaded",t._sounds=[],t._endTimers={},t._queue=[],t._playLock=!1,t._onend=e.onend?[{fn:e.onend}]:[],t._onfade=e.onfade?[{fn:e.onfade}]:[],t._onload=e.onload?[{fn:e.onload}]:[],t._onloaderror=e.onloaderror?[{fn:e.onloaderror}]:[],t._onplayerror=e.onplayerror?[{fn:e.onplayerror}]:[],t._onpause=e.onpause?[{fn:e.onpause}]:[],t._onplay=e.onplay?[{fn:e.onplay}]:[],t._onstop=e.onstop?[{fn:e.onstop}]:[],t._onmute=e.onmute?[{fn:e.onmute}]:[],t._onvolume=e.onvolume?[{fn:e.onvolume}]:[],t._onrate=e.onrate?[{fn:e.onrate}]:[],t._onseek=e.onseek?[{fn:e.onseek}]:[],t._onunlock=e.onunlock?[{fn:e.onunlock}]:[],t._onresume=[],t._webAudio=s.usingWebAudio&&!t._html5,void 0!==s.ctx&&s.ctx&&s.autoUnlock&&s._unlockAudio(),s._howls.push(t),t._autoplay&&t._queue.push({event:"play",action:function(){t.play()}}),t._preload&&"none"!==t._preload&&t.load(),t},load:function(){var e=this,t=null;if(s.noAudio)e._emit("loaderror",null,"No audio support.");else{"string"==typeof e._src&&(e._src=[e._src]);for(var i=0;i<e._src.length;i++){var n,o;if(e._format&&e._format[i])n=e._format[i];else{if("string"!=typeof(o=e._src[i])){e._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(n=/^data:audio\/([^;,]+);/i.exec(o))||(n=/\.([^.]+)$/.exec(o.split("?",1)[0])),n&&(n=n[1].toLowerCase())}if(n||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),n&&s.codecs(n)){t=e._src[i];break}}if(t)return e._src=t,e._state="loading","https:"===window.location.protocol&&"http:"===t.slice(0,5)&&(e._html5=!0,e._webAudio=!1),new a(e),e._webAudio&&d(e),e;e._emit("loaderror",null,"No codec support for selected audio sources.")}},play:function(e,t){var i=this,n=null;if("number"==typeof e)n=e,e=null;else{if("string"==typeof e&&"loaded"===i._state&&!i._sprite[e])return null;if(void 0===e&&(e="__default",!i._playLock)){for(var o=0,r=0;r<i._sounds.length;r++)i._sounds[r]._paused&&!i._sounds[r]._ended&&(o++,n=i._sounds[r]._id);1===o?e=null:n=null}}var a=n?i._soundById(n):i._inactiveSound();if(!a)return null;if(n&&!e&&(e=a._sprite||"__default"),"loaded"!==i._state){a._sprite=e,a._ended=!1;var u=a._id;return i._queue.push({event:"play",action:function(){i.play(u)}}),u}if(n&&!a._paused)return t||i._loadQueue("play"),a._id;i._webAudio&&s._autoResume();var d=Math.max(0,a._seek>0?a._seek:i._sprite[e][0]/1e3),h=Math.max(0,(i._sprite[e][0]+i._sprite[e][1])/1e3-d),l=1e3*h/Math.abs(a._rate),c=i._sprite[e][0]/1e3,_=(i._sprite[e][0]+i._sprite[e][1])/1e3;a._sprite=e,a._ended=!1;var m=function(){a._paused=!1,a._seek=d,a._start=c,a._stop=_,a._loop=!(!a._loop&&!i._sprite[e][2])};if(!(d>=_)){var p=a._node;if(i._webAudio){var f=function(){i._playLock=!1,m(),i._refreshBuffer(a);var e=a._muted||i._muted?0:a._volume;p.gain.setValueAtTime(e,s.ctx.currentTime),a._playStart=s.ctx.currentTime,void 0===p.bufferSource.start?a._loop?p.bufferSource.noteGrainOn(0,d,86400):p.bufferSource.noteGrainOn(0,d,h):a._loop?p.bufferSource.start(0,d,86400):p.bufferSource.start(0,d,h),l!==1/0&&(i._endTimers[a._id]=setTimeout(i._ended.bind(i,a),l)),t||setTimeout((function(){i._emit("play",a._id),i._loadQueue()}),0)};"running"===s.state&&"interrupted"!==s.ctx.state?f():(i._playLock=!0,i.once("resume",f),i._clearTimer(a._id))}else{var g=function(){p.currentTime=d,p.muted=a._muted||i._muted||s._muted||p.muted,p.volume=a._volume*s.volume(),p.playbackRate=a._rate;try{var n=p.play();if(n&&"undefined"!=typeof Promise&&(n instanceof Promise||"function"==typeof n.then)?(i._playLock=!0,m(),n.then((function(){i._playLock=!1,p._unlocked=!0,t?i._loadQueue():i._emit("play",a._id)})).catch((function(){i._playLock=!1,i._emit("playerror",a._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),a._ended=!0,a._paused=!0}))):t||(i._playLock=!1,m(),i._emit("play",a._id)),p.playbackRate=a._rate,p.paused)return void i._emit("playerror",a._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");"__default"!==e||a._loop?i._endTimers[a._id]=setTimeout(i._ended.bind(i,a),l):(i._endTimers[a._id]=function(){i._ended(a),p.removeEventListener("ended",i._endTimers[a._id],!1)},p.addEventListener("ended",i._endTimers[a._id],!1))}catch(e){i._emit("playerror",a._id,e)}};"data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"===p.src&&(p.src=i._src,p.load());var w=window&&window.ejecta||!p.readyState&&s._navigator.isCocoonJS;if(p.readyState>=3||w)g();else{i._playLock=!0,i._state="loading";var y=function(){i._state="loaded",g(),p.removeEventListener(s._canPlayEvent,y,!1)};p.addEventListener(s._canPlayEvent,y,!1),i._clearTimer(a._id)}}return a._id}i._ended(a)},pause:function(e){var t=this;if("loaded"!==t._state||t._playLock)return t._queue.push({event:"pause",action:function(){t.pause(e)}}),t;for(var i=t._getSoundIds(e),n=0;n<i.length;n++){t._clearTimer(i[n]);var o=t._soundById(i[n]);if(o&&!o._paused&&(o._seek=t.seek(i[n]),o._rateSeek=0,o._paused=!0,t._stopFade(i[n]),o._node))if(t._webAudio){if(!o._node.bufferSource)continue;void 0===o._node.bufferSource.stop?o._node.bufferSource.noteOff(0):o._node.bufferSource.stop(0),t._cleanBuffer(o._node)}else isNaN(o._node.duration)&&o._node.duration!==1/0||o._node.pause();arguments[1]||t._emit("pause",o?o._id:null)}return t},stop:function(e,t){var i=this;if("loaded"!==i._state||i._playLock)return i._queue.push({event:"stop",action:function(){i.stop(e)}}),i;for(var n=i._getSoundIds(e),o=0;o<n.length;o++){i._clearTimer(n[o]);var s=i._soundById(n[o]);s&&(s._seek=s._start||0,s._rateSeek=0,s._paused=!0,s._ended=!0,i._stopFade(n[o]),s._node&&(i._webAudio?s._node.bufferSource&&(void 0===s._node.bufferSource.stop?s._node.bufferSource.noteOff(0):s._node.bufferSource.stop(0),i._cleanBuffer(s._node)):isNaN(s._node.duration)&&s._node.duration!==1/0||(s._node.currentTime=s._start||0,s._node.pause(),s._node.duration===1/0&&i._clearSound(s._node))),t||i._emit("stop",s._id))}return i},mute:function(e,t){var i=this;if("loaded"!==i._state||i._playLock)return i._queue.push({event:"mute",action:function(){i.mute(e,t)}}),i;if(void 0===t){if("boolean"!=typeof e)return i._muted;i._muted=e}for(var n=i._getSoundIds(t),o=0;o<n.length;o++){var r=i._soundById(n[o]);r&&(r._muted=e,r._interval&&i._stopFade(r._id),i._webAudio&&r._node?r._node.gain.setValueAtTime(e?0:r._volume,s.ctx.currentTime):r._node&&(r._node.muted=!!s._muted||e),i._emit("mute",r._id))}return i},volume:function(){var e,t,i,n=this,o=arguments;if(0===o.length)return n._volume;if(1===o.length||2===o.length&&void 0===o[1]){var r=n._getSoundIds(),a=r.indexOf(o[0]);a>=0?t=parseInt(o[0],10):e=parseFloat(o[0])}else o.length>=2&&(e=parseFloat(o[0]),t=parseInt(o[1],10));if(!(void 0!==e&&e>=0&&e<=1))return(i=t?n._soundById(t):n._sounds[0])?i._volume:0;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"volume",action:function(){n.volume.apply(n,o)}}),n;void 0===t&&(n._volume=e),t=n._getSoundIds(t);for(var u=0;u<t.length;u++)(i=n._soundById(t[u]))&&(i._volume=e,o[2]||n._stopFade(t[u]),n._webAudio&&i._node&&!i._muted?i._node.gain.setValueAtTime(e,s.ctx.currentTime):i._node&&!i._muted&&(i._node.volume=e*s.volume()),n._emit("volume",i._id));return n},fade:function(e,t,i,n){var o=this;if("loaded"!==o._state||o._playLock)return o._queue.push({event:"fade",action:function(){o.fade(e,t,i,n)}}),o;e=Math.min(Math.max(0,parseFloat(e)),1),t=Math.min(Math.max(0,parseFloat(t)),1),i=parseFloat(i),o.volume(e,n);for(var r=o._getSoundIds(n),a=0;a<r.length;a++){var u=o._soundById(r[a]);if(u){if(n||o._stopFade(r[a]),o._webAudio&&!u._muted){var d=s.ctx.currentTime,h=d+i/1e3;u._volume=e,u._node.gain.setValueAtTime(e,d),u._node.gain.linearRampToValueAtTime(t,h)}o._startFadeInterval(u,e,t,i,r[a],void 0===n)}}return o},_startFadeInterval:function(e,t,i,n,o,s){var r=this,a=t,u=i-t,d=Math.abs(u/.01),h=Math.max(4,d>0?n/d:n),l=Date.now();e._fadeTo=i,e._interval=setInterval((function(){var o=(Date.now()-l)/n;l=Date.now(),a+=u*o,a=Math.round(100*a)/100,a=u<0?Math.max(i,a):Math.min(i,a),r._webAudio?e._volume=a:r.volume(a,e._id,!0),s&&(r._volume=a),(i<t&&a<=i||i>t&&a>=i)&&(clearInterval(e._interval),e._interval=null,e._fadeTo=null,r.volume(i,e._id),r._emit("fade",e._id))}),h)},_stopFade:function(e){var t=this,i=t._soundById(e);return i&&i._interval&&(t._webAudio&&i._node.gain.cancelScheduledValues(s.ctx.currentTime),clearInterval(i._interval),i._interval=null,t.volume(i._fadeTo,e),i._fadeTo=null,t._emit("fade",e)),t},loop:function(){var e,t,i,n=this,o=arguments;if(0===o.length)return n._loop;if(1===o.length){if("boolean"!=typeof o[0])return!!(i=n._soundById(parseInt(o[0],10)))&&i._loop;e=o[0],n._loop=e}else 2===o.length&&(e=o[0],t=parseInt(o[1],10));for(var s=n._getSoundIds(t),r=0;r<s.length;r++)(i=n._soundById(s[r]))&&(i._loop=e,n._webAudio&&i._node&&i._node.bufferSource&&(i._node.bufferSource.loop=e,e&&(i._node.bufferSource.loopStart=i._start||0,i._node.bufferSource.loopEnd=i._stop,n.playing(s[r])&&(n.pause(s[r],!0),n.play(s[r],!0)))));return n},rate:function(){var e,t,i,n=this,o=arguments;if(0===o.length)t=n._sounds[0]._id;else if(1===o.length){var r=n._getSoundIds(),a=r.indexOf(o[0]);a>=0?t=parseInt(o[0],10):e=parseFloat(o[0])}else 2===o.length&&(e=parseFloat(o[0]),t=parseInt(o[1],10));if("number"!=typeof e)return(i=n._soundById(t))?i._rate:n._rate;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"rate",action:function(){n.rate.apply(n,o)}}),n;void 0===t&&(n._rate=e),t=n._getSoundIds(t);for(var u=0;u<t.length;u++)if(i=n._soundById(t[u])){n.playing(t[u])&&(i._rateSeek=n.seek(t[u]),i._playStart=n._webAudio?s.ctx.currentTime:i._playStart),i._rate=e,n._webAudio&&i._node&&i._node.bufferSource?i._node.bufferSource.playbackRate.setValueAtTime(e,s.ctx.currentTime):i._node&&(i._node.playbackRate=e);var d=n.seek(t[u]),h=(n._sprite[i._sprite][0]+n._sprite[i._sprite][1])/1e3-d,l=1e3*h/Math.abs(i._rate);!n._endTimers[t[u]]&&i._paused||(n._clearTimer(t[u]),n._endTimers[t[u]]=setTimeout(n._ended.bind(n,i),l)),n._emit("rate",i._id)}return n},seek:function(){var e,t,i=this,n=arguments;if(0===n.length)i._sounds.length&&(t=i._sounds[0]._id);else if(1===n.length){var o=i._getSoundIds(),r=o.indexOf(n[0]);r>=0?t=parseInt(n[0],10):i._sounds.length&&(t=i._sounds[0]._id,e=parseFloat(n[0]))}else 2===n.length&&(e=parseFloat(n[0]),t=parseInt(n[1],10));if(void 0===t)return 0;if("number"==typeof e&&("loaded"!==i._state||i._playLock))return i._queue.push({event:"seek",action:function(){i.seek.apply(i,n)}}),i;var a=i._soundById(t);if(a){if(!("number"==typeof e&&e>=0)){if(i._webAudio){var u=i.playing(t)?s.ctx.currentTime-a._playStart:0,d=a._rateSeek?a._rateSeek-a._seek:0;return a._seek+(d+u*Math.abs(a._rate))}return a._node.currentTime}var h=i.playing(t);h&&i.pause(t,!0),a._seek=e,a._ended=!1,i._clearTimer(t),i._webAudio||!a._node||isNaN(a._node.duration)||(a._node.currentTime=e);var l=function(){h&&i.play(t,!0),i._emit("seek",t)};if(h&&!i._webAudio){var c=function(){i._playLock?setTimeout(c,0):l()};setTimeout(c,0)}else l()}return i},playing:function(e){var t=this;if("number"==typeof e){var i=t._soundById(e);return!!i&&!i._paused}for(var n=0;n<t._sounds.length;n++)if(!t._sounds[n]._paused)return!0;return!1},duration:function(e){var t=this,i=t._duration,n=t._soundById(e);return n&&(i=t._sprite[n._sprite][1]/1e3),i},state:function(){return this._state},unload:function(){for(var e=this,t=e._sounds,i=0;i<t.length;i++)t[i]._paused||e.stop(t[i]._id),e._webAudio||(e._clearSound(t[i]._node),t[i]._node.removeEventListener("error",t[i]._errorFn,!1),t[i]._node.removeEventListener(s._canPlayEvent,t[i]._loadFn,!1),t[i]._node.removeEventListener("ended",t[i]._endFn,!1),s._releaseHtml5Audio(t[i]._node)),delete t[i]._node,e._clearTimer(t[i]._id);var n=s._howls.indexOf(e);n>=0&&s._howls.splice(n,1);var o=!0;for(i=0;i<s._howls.length;i++)if(s._howls[i]._src===e._src||e._src.indexOf(s._howls[i]._src)>=0){o=!1;break}return u&&o&&delete u[e._src],s.noAudio=!1,e._state="unloaded",e._sounds=[],e=null,null},on:function(e,t,i,n){var o=this["_on"+e];return"function"==typeof t&&o.push(n?{id:i,fn:t,once:n}:{id:i,fn:t}),this},off:function(e,t,i){var n=this,o=n["_on"+e],s=0;if("number"==typeof t&&(i=t,t=null),t||i)for(s=0;s<o.length;s++){var r=i===o[s].id;if(t===o[s].fn&&r||!t&&r){o.splice(s,1);break}}else if(e)n["_on"+e]=[];else{var a=Object.keys(n);for(s=0;s<a.length;s++)0===a[s].indexOf("_on")&&Array.isArray(n[a[s]])&&(n[a[s]]=[])}return n},once:function(e,t,i){return this.on(e,t,i,1),this},_emit:function(e,t,i){for(var n=this,o=n["_on"+e],s=o.length-1;s>=0;s--)o[s].id&&o[s].id!==t&&"load"!==e||(setTimeout(function(e){e.call(this,t,i)}.bind(n,o[s].fn),0),o[s].once&&n.off(e,o[s].fn,o[s].id));return n._loadQueue(e),n},_loadQueue:function(e){var t=this;if(t._queue.length>0){var i=t._queue[0];i.event===e&&(t._queue.shift(),t._loadQueue()),e||i.action()}return t},_ended:function(e){var t=this,i=e._sprite;if(!t._webAudio&&e._node&&!e._node.paused&&!e._node.ended&&e._node.currentTime<e._stop)return setTimeout(t._ended.bind(t,e),100),t;var n=!(!e._loop&&!t._sprite[i][2]);if(t._emit("end",e._id),!t._webAudio&&n&&t.stop(e._id,!0).play(e._id),t._webAudio&&n){t._emit("play",e._id),e._seek=e._start||0,e._rateSeek=0,e._playStart=s.ctx.currentTime;var o=1e3*(e._stop-e._start)/Math.abs(e._rate);t._endTimers[e._id]=setTimeout(t._ended.bind(t,e),o)}return t._webAudio&&!n&&(e._paused=!0,e._ended=!0,e._seek=e._start||0,e._rateSeek=0,t._clearTimer(e._id),t._cleanBuffer(e._node),s._autoSuspend()),t._webAudio||n||t.stop(e._id,!0),t},_clearTimer:function(e){var t=this;if(t._endTimers[e]){if("function"!=typeof t._endTimers[e])clearTimeout(t._endTimers[e]);else{var i=t._soundById(e);i&&i._node&&i._node.removeEventListener("ended",t._endTimers[e],!1)}delete t._endTimers[e]}return t},_soundById:function(e){for(var t=this,i=0;i<t._sounds.length;i++)if(e===t._sounds[i]._id)return t._sounds[i];return null},_inactiveSound:function(){var e=this;e._drain();for(var t=0;t<e._sounds.length;t++)if(e._sounds[t]._ended)return e._sounds[t].reset();return new a(e)},_drain:function(){var e=this,t=e._pool,i=0,n=0;if(!(e._sounds.length<t)){for(n=0;n<e._sounds.length;n++)e._sounds[n]._ended&&i++;for(n=e._sounds.length-1;n>=0;n--){if(i<=t)return;e._sounds[n]._ended&&(e._webAudio&&e._sounds[n]._node&&e._sounds[n]._node.disconnect(0),e._sounds.splice(n,1),i--)}}},_getSoundIds:function(e){if(void 0===e){for(var t=[],i=0;i<this._sounds.length;i++)t.push(this._sounds[i]._id);return t}return[e]},_refreshBuffer:function(e){return e._node.bufferSource=s.ctx.createBufferSource(),e._node.bufferSource.buffer=u[this._src],e._panner?e._node.bufferSource.connect(e._panner):e._node.bufferSource.connect(e._node),e._node.bufferSource.loop=e._loop,e._loop&&(e._node.bufferSource.loopStart=e._start||0,e._node.bufferSource.loopEnd=e._stop||0),e._node.bufferSource.playbackRate.setValueAtTime(e._rate,s.ctx.currentTime),this},_cleanBuffer:function(e){var t=s._navigator&&s._navigator.vendor.indexOf("Apple")>=0;if(s._scratchBuffer&&e.bufferSource&&(e.bufferSource.onended=null,e.bufferSource.disconnect(0),t))try{e.bufferSource.buffer=s._scratchBuffer}catch(e){}return e.bufferSource=null,this},_clearSound:function(e){/MSIE |Trident\//.test(s._navigator&&s._navigator.userAgent)||(e.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var a=function(e){this._parent=e,this.init()};a.prototype={init:function(){var e=this,t=e._parent;return e._muted=t._muted,e._loop=t._loop,e._volume=t._volume,e._rate=t._rate,e._seek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++s._counter,t._sounds.push(e),e.create(),e},create:function(){var e=this,t=e._parent,i=s._muted||e._muted||e._parent._muted?0:e._volume;return t._webAudio?(e._node=void 0===s.ctx.createGain?s.ctx.createGainNode():s.ctx.createGain(),e._node.gain.setValueAtTime(i,s.ctx.currentTime),e._node.paused=!0,e._node.connect(s.masterGain)):s.noAudio||(e._node=s._obtainHtml5Audio(),e._errorFn=e._errorListener.bind(e),e._node.addEventListener("error",e._errorFn,!1),e._loadFn=e._loadListener.bind(e),e._node.addEventListener(s._canPlayEvent,e._loadFn,!1),e._endFn=e._endListener.bind(e),e._node.addEventListener("ended",e._endFn,!1),e._node.src=t._src,e._node.preload=!0===t._preload?"auto":t._preload,e._node.volume=i*s.volume(),e._node.load()),e},reset:function(){var e=this,t=e._parent;return e._muted=t._muted,e._loop=t._loop,e._volume=t._volume,e._rate=t._rate,e._seek=0,e._rateSeek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++s._counter,e},_errorListener:function(){var e=this;e._parent._emit("loaderror",e._id,e._node.error?e._node.error.code:0),e._node.removeEventListener("error",e._errorFn,!1)},_loadListener:function(){var e=this,t=e._parent;t._duration=Math.ceil(10*e._node.duration)/10,0===Object.keys(t._sprite).length&&(t._sprite={__default:[0,1e3*t._duration]}),"loaded"!==t._state&&(t._state="loaded",t._emit("load"),t._loadQueue()),e._node.removeEventListener(s._canPlayEvent,e._loadFn,!1)},_endListener:function(){var e=this,t=e._parent;t._duration===1/0&&(t._duration=Math.ceil(10*e._node.duration)/10,t._sprite.__default[1]===1/0&&(t._sprite.__default[1]=1e3*t._duration),t._ended(e)),e._node.removeEventListener("ended",e._endFn,!1)}};var u={},d=function(e){var t=e._src;if(u[t])return e._duration=u[t].duration,void c(e);if(/^data:[^;]+;base64,/.test(t)){for(var i=atob(t.split(",")[1]),n=new Uint8Array(i.length),o=0;o<i.length;++o)n[o]=i.charCodeAt(o);l(n.buffer,e)}else{var s=new XMLHttpRequest;s.open(e._xhr.method,t,!0),s.withCredentials=e._xhr.withCredentials,s.responseType="arraybuffer",e._xhr.headers&&Object.keys(e._xhr.headers).forEach((function(t){s.setRequestHeader(t,e._xhr.headers[t])})),s.onload=function(){var t=(s.status+"")[0];"0"===t||"2"===t||"3"===t?l(s.response,e):e._emit("loaderror",null,"Failed loading audio file with status: "+s.status+".")},s.onerror=function(){e._webAudio&&(e._html5=!0,e._webAudio=!1,e._sounds=[],delete u[t],e.load())},h(s)}},h=function(e){try{e.send()}catch(t){e.onerror()}},l=function(e,t){var i=function(){t._emit("loaderror",null,"Decoding audio data failed.")},n=function(e){e&&t._sounds.length>0?(u[t._src]=e,c(t,e)):i()};"undefined"!=typeof Promise&&1===s.ctx.decodeAudioData.length?s.ctx.decodeAudioData(e).then(n).catch(i):s.ctx.decodeAudioData(e,n,i)},c=function(e,t){t&&!e._duration&&(e._duration=t.duration),0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),"loaded"!==e._state&&(e._state="loaded",e._emit("load"),e._loadQueue())},_=function(){if(s.usingWebAudio){try{"undefined"!=typeof AudioContext?s.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?s.ctx=new webkitAudioContext:s.usingWebAudio=!1}catch(e){s.usingWebAudio=!1}s.ctx||(s.usingWebAudio=!1);var e=/iP(hone|od|ad)/.test(s._navigator&&s._navigator.platform),t=s._navigator&&s._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),i=t?parseInt(t[1],10):null;if(e&&i&&i<9){var n=/safari/.test(s._navigator&&s._navigator.userAgent.toLowerCase());s._navigator&&!n&&(s.usingWebAudio=!1)}s.usingWebAudio&&(s.masterGain=void 0===s.ctx.createGain?s.ctx.createGainNode():s.ctx.createGain(),s.masterGain.gain.setValueAtTime(s._muted?0:s._volume,s.ctx.currentTime),s.masterGain.connect(s.ctx.destination)),s._setup()}};void 0===(n=function(){return{Howler:s,Howl:r}}.apply(t,[]))||(e.exports=n),t.Howler=s,t.Howl=r,void 0!==i.g?(i.g.HowlerGlobal=o,i.g.Howler=s,i.g.Howl=r,i.g.Sound=a):"undefined"!=typeof window&&(window.HowlerGlobal=o,window.Howler=s,window.Howl=r,window.Sound=a)}(),function(){"use strict";var e;HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(e){var t=this;if(!t.ctx||!t.ctx.listener)return t;for(var i=t._howls.length-1;i>=0;i--)t._howls[i].stereo(e);return t},HowlerGlobal.prototype.pos=function(e,t,i){var n=this;return n.ctx&&n.ctx.listener?(t="number"!=typeof t?n._pos[1]:t,i="number"!=typeof i?n._pos[2]:i,"number"!=typeof e?n._pos:(n._pos=[e,t,i],void 0!==n.ctx.listener.positionX?(n.ctx.listener.positionX.setTargetAtTime(n._pos[0],Howler.ctx.currentTime,.1),n.ctx.listener.positionY.setTargetAtTime(n._pos[1],Howler.ctx.currentTime,.1),n.ctx.listener.positionZ.setTargetAtTime(n._pos[2],Howler.ctx.currentTime,.1)):n.ctx.listener.setPosition(n._pos[0],n._pos[1],n._pos[2]),n)):n},HowlerGlobal.prototype.orientation=function(e,t,i,n,o,s){var r=this;if(!r.ctx||!r.ctx.listener)return r;var a=r._orientation;return t="number"!=typeof t?a[1]:t,i="number"!=typeof i?a[2]:i,n="number"!=typeof n?a[3]:n,o="number"!=typeof o?a[4]:o,s="number"!=typeof s?a[5]:s,"number"!=typeof e?a:(r._orientation=[e,t,i,n,o,s],void 0!==r.ctx.listener.forwardX?(r.ctx.listener.forwardX.setTargetAtTime(e,Howler.ctx.currentTime,.1),r.ctx.listener.forwardY.setTargetAtTime(t,Howler.ctx.currentTime,.1),r.ctx.listener.forwardZ.setTargetAtTime(i,Howler.ctx.currentTime,.1),r.ctx.listener.upX.setTargetAtTime(n,Howler.ctx.currentTime,.1),r.ctx.listener.upY.setTargetAtTime(o,Howler.ctx.currentTime,.1),r.ctx.listener.upZ.setTargetAtTime(s,Howler.ctx.currentTime,.1)):r.ctx.listener.setOrientation(e,t,i,n,o,s),r)},Howl.prototype.init=(e=Howl.prototype.init,function(t){var i=this;return i._orientation=t.orientation||[1,0,0],i._stereo=t.stereo||null,i._pos=t.pos||null,i._pannerAttr={coneInnerAngle:void 0!==t.coneInnerAngle?t.coneInnerAngle:360,coneOuterAngle:void 0!==t.coneOuterAngle?t.coneOuterAngle:360,coneOuterGain:void 0!==t.coneOuterGain?t.coneOuterGain:0,distanceModel:void 0!==t.distanceModel?t.distanceModel:"inverse",maxDistance:void 0!==t.maxDistance?t.maxDistance:1e4,panningModel:void 0!==t.panningModel?t.panningModel:"HRTF",refDistance:void 0!==t.refDistance?t.refDistance:1,rolloffFactor:void 0!==t.rolloffFactor?t.rolloffFactor:1},i._onstereo=t.onstereo?[{fn:t.onstereo}]:[],i._onpos=t.onpos?[{fn:t.onpos}]:[],i._onorientation=t.onorientation?[{fn:t.onorientation}]:[],e.call(this,t)}),Howl.prototype.stereo=function(e,i){var n=this;if(!n._webAudio)return n;if("loaded"!==n._state)return n._queue.push({event:"stereo",action:function(){n.stereo(e,i)}}),n;var o=void 0===Howler.ctx.createStereoPanner?"spatial":"stereo";if(void 0===i){if("number"!=typeof e)return n._stereo;n._stereo=e,n._pos=[e,0,0]}for(var s=n._getSoundIds(i),r=0;r<s.length;r++){var a=n._soundById(s[r]);if(a){if("number"!=typeof e)return a._stereo;a._stereo=e,a._pos=[e,0,0],a._node&&(a._pannerAttr.panningModel="equalpower",a._panner&&a._panner.pan||t(a,o),"spatial"===o?void 0!==a._panner.positionX?(a._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),a._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),a._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):a._panner.setPosition(e,0,0):a._panner.pan.setValueAtTime(e,Howler.ctx.currentTime)),n._emit("stereo",a._id)}}return n},Howl.prototype.pos=function(e,i,n,o){var s=this;if(!s._webAudio)return s;if("loaded"!==s._state)return s._queue.push({event:"pos",action:function(){s.pos(e,i,n,o)}}),s;if(i="number"!=typeof i?0:i,n="number"!=typeof n?-.5:n,void 0===o){if("number"!=typeof e)return s._pos;s._pos=[e,i,n]}for(var r=s._getSoundIds(o),a=0;a<r.length;a++){var u=s._soundById(r[a]);if(u){if("number"!=typeof e)return u._pos;u._pos=[e,i,n],u._node&&(u._panner&&!u._panner.pan||t(u,"spatial"),void 0!==u._panner.positionX?(u._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),u._panner.positionY.setValueAtTime(i,Howler.ctx.currentTime),u._panner.positionZ.setValueAtTime(n,Howler.ctx.currentTime)):u._panner.setPosition(e,i,n)),s._emit("pos",u._id)}}return s},Howl.prototype.orientation=function(e,i,n,o){var s=this;if(!s._webAudio)return s;if("loaded"!==s._state)return s._queue.push({event:"orientation",action:function(){s.orientation(e,i,n,o)}}),s;if(i="number"!=typeof i?s._orientation[1]:i,n="number"!=typeof n?s._orientation[2]:n,void 0===o){if("number"!=typeof e)return s._orientation;s._orientation=[e,i,n]}for(var r=s._getSoundIds(o),a=0;a<r.length;a++){var u=s._soundById(r[a]);if(u){if("number"!=typeof e)return u._orientation;u._orientation=[e,i,n],u._node&&(u._panner||(u._pos||(u._pos=s._pos||[0,0,-.5]),t(u,"spatial")),void 0!==u._panner.orientationX?(u._panner.orientationX.setValueAtTime(e,Howler.ctx.currentTime),u._panner.orientationY.setValueAtTime(i,Howler.ctx.currentTime),u._panner.orientationZ.setValueAtTime(n,Howler.ctx.currentTime)):u._panner.setOrientation(e,i,n)),s._emit("orientation",u._id)}}return s},Howl.prototype.pannerAttr=function(){var e,i,n,o=this,s=arguments;if(!o._webAudio)return o;if(0===s.length)return o._pannerAttr;if(1===s.length){if("object"!=typeof s[0])return(n=o._soundById(parseInt(s[0],10)))?n._pannerAttr:o._pannerAttr;e=s[0],void 0===i&&(e.pannerAttr||(e.pannerAttr={coneInnerAngle:e.coneInnerAngle,coneOuterAngle:e.coneOuterAngle,coneOuterGain:e.coneOuterGain,distanceModel:e.distanceModel,maxDistance:e.maxDistance,refDistance:e.refDistance,rolloffFactor:e.rolloffFactor,panningModel:e.panningModel}),o._pannerAttr={coneInnerAngle:void 0!==e.pannerAttr.coneInnerAngle?e.pannerAttr.coneInnerAngle:o._coneInnerAngle,coneOuterAngle:void 0!==e.pannerAttr.coneOuterAngle?e.pannerAttr.coneOuterAngle:o._coneOuterAngle,coneOuterGain:void 0!==e.pannerAttr.coneOuterGain?e.pannerAttr.coneOuterGain:o._coneOuterGain,distanceModel:void 0!==e.pannerAttr.distanceModel?e.pannerAttr.distanceModel:o._distanceModel,maxDistance:void 0!==e.pannerAttr.maxDistance?e.pannerAttr.maxDistance:o._maxDistance,refDistance:void 0!==e.pannerAttr.refDistance?e.pannerAttr.refDistance:o._refDistance,rolloffFactor:void 0!==e.pannerAttr.rolloffFactor?e.pannerAttr.rolloffFactor:o._rolloffFactor,panningModel:void 0!==e.pannerAttr.panningModel?e.pannerAttr.panningModel:o._panningModel})}else 2===s.length&&(e=s[0],i=parseInt(s[1],10));for(var r=o._getSoundIds(i),a=0;a<r.length;a++)if(n=o._soundById(r[a])){var u=n._pannerAttr;u={coneInnerAngle:void 0!==e.coneInnerAngle?e.coneInnerAngle:u.coneInnerAngle,coneOuterAngle:void 0!==e.coneOuterAngle?e.coneOuterAngle:u.coneOuterAngle,coneOuterGain:void 0!==e.coneOuterGain?e.coneOuterGain:u.coneOuterGain,distanceModel:void 0!==e.distanceModel?e.distanceModel:u.distanceModel,maxDistance:void 0!==e.maxDistance?e.maxDistance:u.maxDistance,refDistance:void 0!==e.refDistance?e.refDistance:u.refDistance,rolloffFactor:void 0!==e.rolloffFactor?e.rolloffFactor:u.rolloffFactor,panningModel:void 0!==e.panningModel?e.panningModel:u.panningModel};var d=n._panner;d?(d.coneInnerAngle=u.coneInnerAngle,d.coneOuterAngle=u.coneOuterAngle,d.coneOuterGain=u.coneOuterGain,d.distanceModel=u.distanceModel,d.maxDistance=u.maxDistance,d.refDistance=u.refDistance,d.rolloffFactor=u.rolloffFactor,d.panningModel=u.panningModel):(n._pos||(n._pos=o._pos||[0,0,-.5]),t(n,"spatial"))}return o},Sound.prototype.init=function(e){return function(){var t=this,i=t._parent;t._orientation=i._orientation,t._stereo=i._stereo,t._pos=i._pos,t._pannerAttr=i._pannerAttr,e.call(this),t._stereo?i.stereo(t._stereo):t._pos&&i.pos(t._pos[0],t._pos[1],t._pos[2],t._id)}}(Sound.prototype.init),Sound.prototype.reset=function(e){return function(){var t=this,i=t._parent;return t._orientation=i._orientation,t._stereo=i._stereo,t._pos=i._pos,t._pannerAttr=i._pannerAttr,t._stereo?i.stereo(t._stereo):t._pos?i.pos(t._pos[0],t._pos[1],t._pos[2],t._id):t._panner&&(t._panner.disconnect(0),t._panner=void 0,i._refreshBuffer(t)),e.call(this)}}(Sound.prototype.reset);var t=function(e,t){"spatial"===(t=t||"spatial")?(e._panner=Howler.ctx.createPanner(),e._panner.coneInnerAngle=e._pannerAttr.coneInnerAngle,e._panner.coneOuterAngle=e._pannerAttr.coneOuterAngle,e._panner.coneOuterGain=e._pannerAttr.coneOuterGain,e._panner.distanceModel=e._pannerAttr.distanceModel,e._panner.maxDistance=e._pannerAttr.maxDistance,e._panner.refDistance=e._pannerAttr.refDistance,e._panner.rolloffFactor=e._pannerAttr.rolloffFactor,e._panner.panningModel=e._pannerAttr.panningModel,void 0!==e._panner.positionX?(e._panner.positionX.setValueAtTime(e._pos[0],Howler.ctx.currentTime),e._panner.positionY.setValueAtTime(e._pos[1],Howler.ctx.currentTime),e._panner.positionZ.setValueAtTime(e._pos[2],Howler.ctx.currentTime)):e._panner.setPosition(e._pos[0],e._pos[1],e._pos[2]),void 0!==e._panner.orientationX?(e._panner.orientationX.setValueAtTime(e._orientation[0],Howler.ctx.currentTime),e._panner.orientationY.setValueAtTime(e._orientation[1],Howler.ctx.currentTime),e._panner.orientationZ.setValueAtTime(e._orientation[2],Howler.ctx.currentTime)):e._panner.setOrientation(e._orientation[0],e._orientation[1],e._orientation[2])):(e._panner=Howler.ctx.createStereoPanner(),e._panner.pan.setValueAtTime(e._stereo,Howler.ctx.currentTime)),e._panner.connect(e._node),e._paused||e._parent.pause(e._id,!0).play(e._id,!0)}}()}},t={};function i(n){var o=t[n];if(void 0!==o)return o.exports;var s=t[n]={exports:{}};return e[n](s,s.exports,i),s.exports}i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),function(){"use strict";const e={knight:{Idle:{row:1,num_rows:1,frames:10,max_frames:10,left_offset:40,right_offset:40,left_pos_offset:-60,right_pos_offset:-20,top_offset_multiplier:1.9},lAttack:{row:1,num_rows:1,frames:10,max_frames:10,left_offset:-20,right_offset:0,left_pos_offset:-260,right_pos_offset:-120,top_offset_multiplier:1.9},hAttack:{row:1,num_rows:1,frames:6,max_frames:6,left_offset:20,right_offset:20,left_pos_offset:0,right_pos_offset:0,top_offset_multiplier:1.9},jump:{row:1,num_rows:1,frames:3,max_frames:3,left_offset:20,right_offset:20,pos_offset:0,left_pos_offset:-130,right_pos_offset:-100,top_offset_multiplier:1.9},jumpFallinbetween:{row:1,num_rows:1,frames:2,max_frames:2,left_offset:20,right_offset:20,left_pos_offset:0,right_pos_offset:0,top_offset_multiplier:1.9},Run:{row:1,num_rows:1,frames:10,max_frames:10,left_offset:40,right_offset:40,left_pos_offset:-40,right_pos_offset:-40,top_offset_multiplier:1.9},hit:{row:1,num_rows:1,frames:1,max_frames:1,left_offset:0,right_offset:0,left_pos_offset:-120,right_pos_offset:-80,top_offset_multiplier:1.9},death:{row:1,num_rows:1,frames:10,max_frames:10,left_offset:0,right_offset:0,left_pos_offset:-260,right_pos_offset:-120,top_offset_multiplier:1.9}},skeleton:{Idle:{row:4,num_rows:5,frames:4,max_frames:13,left_offset:0,right_offset:0,left_pos_offset:-80,right_pos_offset:-80,top_offset_multiplier:1.8},lAttack:{row:1,num_rows:5,frames:13,max_frames:13,left_offset:0,right_offset:0,left_pos_offset:-80,right_pos_offset:-80,top_offset_multiplier:4.6},death:{row:2,num_rows:5,frames:13,max_frames:13,left_offset:0,right_offset:0,left_pos_offset:-80,right_pos_offset:-80,top_offset_multiplier:1.7},hit:{row:2,num_rows:5,frames:3,max_frames:13,left_offset:0,right_offset:0,left_pos_offset:-80,right_pos_offset:-80,top_offset_multiplier:1.65},Run:{row:3,num_rows:5,frames:12,max_frames:13,left_offset:0,right_offset:0,left_pos_offset:-80,right_pos_offset:-80,top_offset_multiplier:1.35}}},t={lightning:{typeA:{row:1,num_rows:2,frames:6,max_frames:6,left_offset:0,right_offset:0,left_pos_offset:0,right_pos_offset:0,top_offset_multiplier:0},typeB:{row:2,num_rows:2,frames:6,max_frames:6,left_offset:0,right_offset:0,left_pos_offset:0,right_pos_offset:0,top_offset_multiplier:0}}};class n{constructor(e){this.game=e,this.ctx=e.ctx,this.dimensions=e.dimensions,this.framesDrawn=0,this.currentFrame=0,this.currentStep=0,this.getNextStep()}draw(e){if(this.currentStep>=4)this.ctx.fillStyle="black",this.ctx.fillRect(0,0,this.dimensions.width,this.dimensions.height),this.ctx.fillStyle="red",this.ctx.font="80px Sans-serif",this.ctx.fillText(`${this.currentInstruction}`,this.dimensions.width/2,this.dimensions.height/2);else{this.currentFrame=this.currentFrame%this.currentData.max_frames;let e=new Image;e.onload=()=>{this.ctx.fillStyle="black",this.ctx.fillRect(0,0,this.dimensions.width,this.dimensions.height);let t,i=e.width/this.currentData.max_frames,n=e.height/this.currentData.num_rows,o=this.currentFrame*i+this.currentData.right_offset,s=n*this.currentData.row/this.currentData.top_offset_multiplier;switch(this.ctx.drawImage(e,o,s,i,n,this.dimensions.width/2.6,this.dimensions.height/2,3*i,3*n),this.ctx.fillStyle="red",this.ctx.font="20px Sans-serif",this.currentStep){case 1:t="Movement Controls: A: Left, S: down, D: right, W: up";break;case 2:t="Use the space bar to jump";break;case 3:t='Attack with "J".  Slay the skeletons before they slay you!'}this.ctx.fillText(`${t}`,this.dimensions.width/2,this.dimensions.height/1.2)},e.src=`./images/knight/${this.currentInstruction}_right.png`,this.framesDrawn++,this.framesDrawn>=10&&(this.currentFrame++,this.framesDrawn=0)}}getNextStep(){this.currentStep++,1===this.currentStep?(this.currentInstruction="Run",this.currentData=e.knight.Run,setTimeout((()=>this.getNextStep()),6e3)):2===this.currentStep?(this.currentInstruction="jump",this.currentData=e.knight.jump,setTimeout((()=>this.getNextStep()),3e3)):3===this.currentStep?(this.currentInstruction="lAttack",this.currentData=e.knight.lAttack,setTimeout((()=>this.getNextStep()),7e3)):4===this.currentStep?(this.currentInstruction="Get Ready...",setTimeout((()=>this.getNextStep()),3e3)):5===this.currentStep&&(this.currentInstruction="Start",setTimeout((()=>this.game.startGame()),1e3))}move(){}performAction(){}}class o{constructor(){this.controls={up:"KeyW",down:"KeyS",left:"KeyA",right:"KeyD",lAttack:"KeyJ",hAttack:"KeyK",throw:"KeyL",jump:"Space"},this.difficulty="easy",this.stage="random",this.sound="on",this.volume={BGM:.5,SFX:.5}}}var s=i(766);class r{constructor(e,t,i,n=!1){this.optionText=e,this.selectedStatus=n,this.selectedAction=i,this.position=t}draw(e){e.fillStyle=this.selectedStatus?"yellow":"red",e.font="30px Comic Sans MS",e.fillText(`${this.optionText}`,this.position[0],this.position[1])}toggleHighlight(){!0===this.selectedStatus?this.selectedStatus=!1:this.selectedStatus=!0}}class a{constructor(e){this.game=e,this.dimensions=e.dimensions,this.ctx=e.ctx,this.createMainMenuOptions(),this.menuReady=!1,setTimeout((()=>this.menuReady=!0),4e3),this.lightningReady=!0,this.framesDrawn=0,this.currentFrame=0,this.startMusic()}move(e){this.menuReady&&(e.up&&(this.menuOptions[this.selectedIdx].toggleHighlight(),this.selectedIdx--,this.selectedIdx<0&&(this.selectedIdx=this.menuOptions.length-1),this.menuOptions[this.selectedIdx].toggleHighlight(),this.lockoutMenu()),e.down&&(this.menuOptions[this.selectedIdx].toggleHighlight(),this.selectedIdx++,this.selectedIdx===this.menuOptions.length&&(this.selectedIdx=0),this.menuOptions[this.selectedIdx].toggleHighlight(),this.lockoutMenu()),e.left,e.right)}performAction(e){this.menuReady&&e.lAttack&&(this.menuOptions[this.selectedIdx].selectedAction(),this.menuReady=!1,this.lockoutMenu())}playMenuMoveSound(){"on"===this.game.options.sound&&(this.sound=new s.Howl({src:["./sounds/menu_sounds/MENU_Pick.wav"]}),this.sound.volume(.1*this.game.options.volume.SFX),this.sound.play())}lockoutMenu(){this.menuReady?(this.playMenuMoveSound(),this.menuReady=!1,setTimeout((()=>this.menuReady=!0),200)):setTimeout((()=>this.menuReady=!0),4e3)}createMainMenuOptions(){this.lockoutMenu(),this.headline="Beat-Em-Up",this.selectedIdx=0;const e=new r("Start",[this.dimensions.width/2,this.dimensions.height/2],this.startGame.bind(this),!0),t=new r("Options",[this.dimensions.width/2,this.dimensions.height/1.6],this.createOptionsMenuOptions.bind(this));this.menuOptions=[e,t]}createOptionsMenuOptions(){this.lockoutMenu(),this.headline="Options",this.selectedIdx=0;const e=new r("Sound",[this.dimensions.width/2,this.dimensions.height/1.85],this.createSoundMenuOptions.bind(this),!0),t=new r("Difficulty",[this.dimensions.width/2,this.dimensions.height/1.6],this.createDifficultyMenuOptions.bind(this)),i=new r("Change Controls",[this.dimensions.width/2,this.dimensions.height/1.4],this.createControlsMenuOptions.bind(this)),n=new r("Back",[this.dimensions.width/2,this.dimensions.height/1.2],this.createMainMenuOptions.bind(this));this.menuOptions=[e,t,i,n]}createControlsMenuOptions(){this.lockoutMenu(),this.headline="Controls",this.selectedIdx=0,this.menuOptions=[new r("Reset Default",[this.dimensions.width/2,this.dimensions.height/3],this.updateControls,!0),new r(`Up: ${this.game.options.controls.up}`,[this.dimensions.width/2,this.dimensions.height/2.5],this.updateControls),new r(`Down: ${this.game.options.controls.down}`,[this.dimensions.width/2,this.dimensions.height/2.2],this.updateControls),new r(`Left: ${this.game.options.controls.left}`,[this.dimensions.width/2,this.dimensions.height/1.95],this.updateControls),new r(`Right: ${this.game.options.controls.right}`,[this.dimensions.width/2,this.dimensions.height/1.75],this.updateControls),new r(`Light Attack: ${this.game.options.controls.lAttack}`,[this.dimensions.width/2,this.dimensions.height/1.59],this.updateControls),new r(`Heavy Attack: ${this.game.options.controls.hAttack}`,[this.dimensions.width/2,this.dimensions.height/1.46],this.updateControls),new r(`Block: ${this.game.options.controls.block}`,[this.dimensions.width/2,this.dimensions.height/1.35],this.updateControls),new r(`Throw/Pick Up Item: ${this.game.options.controls.throw}`,[this.dimensions.width/2,this.dimensions.height/1.26],this.updateControls),new r("Confirm Changes",[this.dimensions.width/2,this.dimensions.height/1.1],this.updateControls),new r("Back",[this.dimensions.width/2,this.dimensions.height/1.04],this.createOptionsMenuOptions.bind(this))]}createDifficultyMenuOptions(){this.lockoutMenu(),this.headline="Difficulty",this.menuOptions=[new r("Easy",[this.dimensions.width/2,this.dimensions.height/1.85],(()=>this.adjustDifficulty("easy")),"easy"===this.game.options.difficulty),new r("Medium",[this.dimensions.width/2,this.dimensions.height/1.6],(()=>this.adjustDifficulty("medium")),"medium"===this.game.options.difficulty),new r("Hard",[this.dimensions.width/2,this.dimensions.height/1.4],(()=>this.adjustDifficulty("hard")),"hard"===this.game.options.difficulty)],this.menuOptions.forEach(((e,t)=>{e.selectedStatus&&(this.selectedIdx=t)}))}createSoundMenuOptions(){this.lockoutMenu(),this.headline="Sound",this.menuOptions=[new r("On",[this.dimensions.width/2,this.dimensions.height/1.85],(()=>this.adjustSound("on")),"on"===this.game.options.sound),new r("Off",[this.dimensions.width/2,this.dimensions.height/1.6],(()=>this.adjustSound("off")),"off"===this.game.options.sound)],this.menuOptions.forEach(((e,t)=>{e.selectedStatus&&(this.selectedIdx=t)}))}draw(e){var i=new Image;if(i.onload=()=>{this.ctx.drawImage(i,0,0,this.dimensions.width,this.dimensions.height)},i.src="./images/gameBackgrounds/titleMenubackground.jpg",this.lightningReady){const e=t.lightning[this.getRandomType()],i=new Image;i.onload=()=>{let t=i.height/e.num_rows,n=i.width/e.max_frames,o=n*this.currentFrame,s=t*e.row;this.currentLightningPos||(this.currentLightningPos=this.getrandomLightningPos()),this.ctx.drawImage(i,o,s,n,t,this.currentLightningPos,0,3*n,3*t),this.framesDrawn++,4===this.framesDrawn&&(this.currentFrame++,this.currentFrame>e.max_frames&&(this.lightningReady=!1,this.currentLightningPos=null,this.startLightningTimeout()),this.framesDrawn=0)},i.src="./images/lightning/lightning.png"}e.font="50px Comic Sans MS",e.fillStyle="red",e.textAlign="center",e.fillText(`${this.headline}`,this.dimensions.width/2,this.dimensions.height/5),this.menuOptions.forEach((t=>t.draw(e)))}startGame(){this.stopMusic(),this.game.startInstructions()}adjustControls(){}adjustDifficulty(e){this.game.options.difficulty=e,this.createOptionsMenuOptions()}adjustSound(e){this.game.options.sound=e,this.createOptionsMenuOptions()}startLightningTimeout(){setTimeout((()=>{this.lightningReady=!0,this.currentFrame=0}),3e3*Math.random())}getRandomType(){return 0===Math.floor(2*Math.random())?"typeA":"typeB"}getrandomLightningPos(){return Math.floor(Math.random()*this.dimensions.width)}startMusic(){"on"===this.game.options.sound&&(this.sound=new s.Howl({src:["./sounds/Searching.ogg"]}),this.sound.volume(.1*this.game.options.volume.BGM),this.sound.play())}stopMusic(){this.sound.stop()}}class u{constructor(e){this.game=e,this.ctx=this.game.ctx,this.dimensions=this.game.dimensions,this.continueDelay=100,this.optionSelected="Yes",this.score=this.game.currentScreen.score,this.score.timer.stopTimer(),this.moveLockout=!0,setTimeout((()=>this.moveLockout=!1),1e3)}draw(){this.ctx.globalAlpha=.5,this.ctx.fillStyle="gray",this.ctx.fillRect(0,0,this.dimensions.width,this.dimensions.height),this.ctx.globalAlpha=1,this.ctx.font="100px Sans-serif",this.ctx.strokeStyle="black",this.ctx.lineWidth=8,this.ctx.fillStyle="red",this.ctx.strokeText("Game Over",this.dimensions.width/2,this.dimensions.height/2-100),this.ctx.fillText("Game Over",this.dimensions.width/2,this.dimensions.height/2-100),this.ctx.fillStyle="yellow",this.ctx.font="60px Sans-serif",this.ctx.strokeText("Retry?",this.dimensions.width/2,this.dimensions.height/2+100),this.ctx.fillText("Retry?",this.dimensions.width/2,this.dimensions.height/2+100),this.ctx.font="40px Sans-serif",this.ctx.fillStyle="Yes"===this.optionSelected?"yellow":"red",this.ctx.strokeText("Yes",this.dimensions.width/2-50,this.dimensions.height-60),this.ctx.fillText("Yes",this.dimensions.width/2-50,this.dimensions.height-60),this.ctx.fillStyle="No"===this.optionSelected?"yellow":"red",this.ctx.strokeText("No",this.dimensions.width/2+50,this.dimensions.height-60),this.ctx.fillText("No",this.dimensions.width/2+50,this.dimensions.height-60)}move(e){this.moveLockout||(e.left||e.right)&&(this.optionSelected="Yes"===this.optionSelected?"No":"Yes",this.playSound(),this.moveLockout=!0,setTimeout((()=>this.moveLockout=!1),200))}performAction(e){this.moveLockout||e.lAttack&&("Yes"===this.optionSelected?(this.playSound(),this.game.currentScreen=new p(this.game)):(this.playSound(),this.game.currentScreen.stopMusic(),this.game.currentScreen=new a(this.game)))}playSound(){"on"===this.game.options.sound&&new Howl({src:["./sounds/menu_sounds/MENU_Pick.wav"]}).play()}}class d{constructor(e,t,i){this.ctx=e,this.dimensions=t,this.owner=i,this.health=100}reduceHealth(e){this.health-=e,this.health<0&&(this.health=0)}increaseHealth(e){}drawLifebar(){"knight"===this.owner.model?(this.ctx.fillStyle="yellow",this.ctx.fillRect(10,20,this.dimensions.width/2-120,30),this.ctx.fillStyle="red",this.ctx.fillRect(10,20,(100-this.health)/100*(this.dimensions.width/2-120),30),this.ctx.font="25px Sans-serif",this.ctx.fillStyle="black",this.ctx.lineWidth=2,this.ctx.fillText("Player Health",100,42)):(this.ctx.fillStyle="yellow",this.ctx.fillRect(this.owner.position[0]-10,this.owner.position[1]-20,this.owner.size.width+20,5),this.ctx.fillStyle="red",this.ctx.fillRect(this.owner.position[0]-10,this.owner.position[1]-20,(100-this.health)/100*(this.owner.size.width+20),5))}}class h{constructor(e,t,i,n="left",o={height:110,width:40},s=[],r=[]){this.game=e,this.model=i,this.currentAnimation="Idle",this.size=o,this.lifebar=new d(this.game.ctx,this.game.dimensions,this),this.position=t,this.stunned=!1,this.currentAction=null,this.hitbox=[],this.directionFaced=n,this.framesDrawn=0,this.currentFrame=0,this.xVel=0,this.yVel=0}resetCurrentFrame(){let t=e[`${this.model}`][`${this.currentAnimation}`];this.comboWindowOpen&&0!==this.currentFrame||(this.currentFrame="right"===this.directionFaced?0:t.max_frames-1)}setCurrentAnimation(){this.currentAction?this.currentAnimation=this.currentAction:0===this.xVel&&0===this.yVel?this.currentAnimation="Idle":this.currentAnimation="Run"}drawCharacter(){this.setCurrentAnimation();let t=new Image,i=e[`${this.model}`][`${this.currentAnimation}`];this.currentFrame=this.currentFrame%i.frames,t.onload=()=>{let e,n=t.width/i.max_frames,o=t.height/i.num_rows;e="left"===this.directionFaced?this.currentFrame*n+(i.max_frames-i.frames)*n+i[`${this.directionFaced}_offset`]:this.currentFrame*n+i[`${this.directionFaced}_offset`];let s=o*i.row/i.top_offset_multiplier;this.game.ctx.drawImage(t,e,s,n,o,this.position[0]+i[`${this.directionFaced}_pos_offset`],this.position[1],3*n,3*o)},"knight"===this.model?t.src=`./images/${this.model}/${this.currentAnimation}_${this.directionFaced}.png`:t.src=`./images/${this.model}/${this.model}_${this.directionFaced}.png`,this.framesDrawn++,this.framesDrawn>=10&&("death"===this.currentAction||"hit"===this.currentAction?"right"===this.directionFaced?this.currentFrame!==i.frames-1&&this.currentFrame++:this.currentFrame!==i.max_frames-i.frames&&this.currentFrame--:("right"===this.directionFaced?this.currentFrame++:this.currentFrame--,this.currentFrame<0&&(this.currentFrame=i.frames-1)),this.framesDrawn=0)}move(){console.log("fell to super class move")}takeDamage(e){"death"===this.currentAnimation||this.iFrames||(this.getHitSound(),this.lifebar.reduceHealth(e),this.stunned=!0,this.currentFrame=0,this.resetCurrentFrame(),this.currentAction="hit",setTimeout((()=>{"death"!==this.currentAction&&(this.currentAction=null)}),500),setTimeout((()=>this.stunned=!1),800),"knight"===this.model&&(this.iFrames=!0,setTimeout((()=>this.iFrames=!1),1500),this.game.currentScreen.startFlashScreen()))}death(){this.getDeathSound(),this.currentFrame=0,this.resetCurrentFrame(),this.stunned=!0,this.currentAction="death"}performLightAttack(){"right"===this.directionFaced?this.hitbox=[this.position[0],this.position[1]+this.size.height,this.position[0]+185,this.position[1]]:this.hitbox=[this.position[0]-175,this.position[1]+this.size.height,this.position[0],this.position[1]],this.currentAction="lAttack",this.comboWindowOpen=!0,setTimeout((()=>{this.comboWindowOpen=!1,this.hitbox=[],this.currentAction=null}),500)}performHeavyAttack(){}performThrow(){}calculateHurtBox(){return[this.position[0],this.position[1]+this.size.height,this.position[0]+this.size.width,this.position[1]]}checkXInbounds(e){return e<this.game.currentScreen.dimensions.width-20&&e>0}checkYInbounds(e){return e>this.game.currentScreen.floorHeight-50&&e<this.game.currentScreen.dimensions.height-80}}class l extends h{constructor(e,t,i="skeleton",n=50){super(e,t,i,1===Math.floor(2*Math.random())?"left":"right"),this.hitBoxRange=[175,50],this.agressionRating=this.getAggressionRating(),this.ActionLockOut=!1,this.scoreBase=n}getAggressionRating(){if("easy"===this.game.options.difficulty)return 10}determineNextAction(){this.stunned||this.ActionLockOut||(this.checkXInbounds(this.position[0])&&this.isPlayerInRange()?this.getRandomInRangeAction():this.move())}facePlayer(){this.game.currentScreen.player.position[0]<this.position[0]?this.directionFaced="left":this.directionFaced="right"}isPlayerInRange(){let e=this.game.currentScreen.player.position;return Math.abs(this.position[0]-e[0])<this.hitBoxRange[0]&&Math.abs(this.position[1]-e[1])<this.hitBoxRange[1]&&"jump"!==this.game.currentScreen.player.currentAction}getRandomInRangeAction(){100*Math.random()<this.agressionRating&&this.performLightAttack()}move(){this.facePlayer(),this.checkXInbounds(this.position[0])?(this.xVel=Math.floor(Math.random())+1,this.yVel=Math.floor(2*Math.random()),"left"===this.directionFaced&&(this.xVel=-this.xVel),this.position[1]>this.game.currentScreen.player.position[1]&&(this.yVel=-this.yVel)):this.xVel="left"===this.directionFaced?-2:2,this.updateCurrentPos()}updateCurrentPos(){this.position[0]+=this.xVel,this.position[1]+=this.yVel}lockOutAction(){this.ActionLockOut=!0,this.xVel=0,this.yVel=0,setTimeout((()=>this.ActionLockOut=!1),500)}posture(){}getAttackTimeOut(){}performAction(){}getHitSound(){}getDeathSound(){}}class c extends h{constructor(e){super(e,[30,450],"knight","right",{height:110,width:40}),this.blockGuage=100,this.blockStatus=!1,this.score=0,this.jumpVel=0,this.jumpHeight=0,this.moveLockOut=!1,this.moveSpeed=1}HIT_SOUNDS=["./sounds/player_sounds/hit/pain1.wav","./sounds/player_sounds/hit/pain2.wav","./sounds/player_sounds/hit/pain3.wav"];ATTACK_SOUNDS=["./sounds/player_sounds/lAttack/hammer-1a.wav","./sounds/player_sounds/lAttack/hammer-1b.wav","./sounds/player_sounds/lAttack/sword-arm-2a.wav","./sounds/player_sounds/lAttack/sword-arm-2b.wav"];RUN_SOUNDS=["./sounds/player_sounds/move/step_metal1.ogg","./sounds/player_sounds/move/step_metal2.ogg","./sounds/player_sounds/move/step_metal3.ogg","./sounds/player_sounds/move/step_metal4.ogg"];lockOutMove(){this.moveLockOut=!0,setTimeout((()=>this.moveLockOut=!1),50)}move(){"jump"===this.currentAction||"death"===this.currentAnimation||this.stunned||(!this.game.controller.up&&this.yVel<0&&(this.yVel+=this.moveSpeed),!this.game.controller.down&&this.yVel>0&&(this.yVel-=this.moveSpeed),!this.game.controller.left&&this.xVel<0&&(this.xVel+=this.moveSpeed),!this.game.controller.right&&this.xVel>0&&(this.xVel-=this.moveSpeed),this.moveLockOut||(this.game.controller.up&&(!this.game.controller.down&&this.yVel>0&&(this.yVel=0),this.dashDirection=null,this.yVel>-5&&(this.yVel-=this.moveSpeed)),this.game.controller.down&&(!this.game.controller.up&&this.yVel<0&&(this.yVel=0),this.dashDirection=null,this.yVel<5&&(this.yVel+=this.moveSpeed)),this.game.controller.left&&(!this.game.controller.right&&this.xVel>0&&(this.xVel=0),"right"===this.dashDirection&&this.dashDirection,(this.xVel>-5||"left"===this.dashDirection&&this.xVel>-15)&&(this.xVel-=this.moveSpeed)),this.game.controller.right&&(!this.game.controller.left&&this.xVel<0&&(this.xVel=0),"left"===this.dashDirection&&this.dashDirection,(this.xVel<5||"right"===this.dashDirection&&this.xVel<15)&&(this.xVel+=this.moveSpeed)))),this.updateNewPos(),this.lockOutMove()}performAction(e){this.currentAction||(e.lAttack?(this.getAttackSound(),this.performLightAttack()):e.hAttack?this.performHeavyAttack():e.jump?this.jump():e.throw&&this.performThrow())}updateNewPos(){let e=this.position.slice();this.stunned&&(this.xVel=0,this.yVel=0),this.checkXInbounds(this.position[0]+this.xVel)&&(this.position[0]+=this.xVel),"jump"!==this.currentAction?(this.checkYInbounds(this.position[1]+this.yVel)&&(this.position[1]+=this.yVel),e[0]===this.position[0]&&e[1]===this.position[1]||this.getRunSound()):(this.yVel<0?(this.position[1]+=this.yVel,this.jumpHeight-=this.yVel,this.yVel+=2.5):this.jumpHeight-this.yVel<0?(this.position[1]+=this.jumpHeight,this.jumpHeight=0,this.yVel=0,this.xVel=0):(this.position[1]+=this.yVel,this.jumpHeight-=this.yVel,this.yVel+=2.5),0===this.yVel&&0===this.jumpHeight&&(this.currentAction=null));let t=this.directionFaced;this.xVel>0&&(this.directionFaced="right"),this.xVel<0&&(this.directionFaced="left"),t!==this.directionFaced&&this.resetCurrentFrame()}jump(){this.currentAction="jump",this.yVel-=40,this.game.controller.left&&!this.game.controller.right&&(this.xVel=-10),this.game.controller.right&&!this.game.controller.left&&(this.xVel=10)}dash(e){this.dashDirection=e}getRunSound(){if(!this.runSoundTimeOut&&(this.runSoundTimeOut=!0,setTimeout((()=>this.runSoundTimeOut=!1),700),"on"===this.game.options.sound)){var e=new Howl({src:["./sounds/player_sounds/move/steps_platform.ogg"]});e.volume(.1*this.game.options.volume.SFX),e.play()}}getAttackSound(){if(this.currentAttackSound||(this.currentAttackSound=0),"on"===this.game.options.sound){var e=new Howl({src:[this.ATTACK_SOUNDS[this.currentAttackSound]]});e.volume(.1*this.game.options.volume.SFX),e.play()}this.currentAttackSound++,this.currentAttackSound=this.currentAttackSound%this.ATTACK_SOUNDS.length}getHitSound(){if(this.currentHitSound||(this.currentHitSound=0),"on"===this.game.options.sound){var e=new Howl({src:[this.HIT_SOUNDS[this.currentHitSound]]});e.volume(.1*this.game.options.volume.SFX),e.play()}this.currentHitSound++,this.currentHitSound=this.currentHitSound%this.ATTACK_SOUNDS.length}getDeathSound(){if("on"===this.game.options.sound){var e=new Howl({src:["./sounds/player_sounds/death/die2.wav"]});e.volume(.1*this.game.options.volume.SFX),e.play()}}}class _{constructor(e,t,i){this.timer=i,this.dimensions=t,this.ctx=e,this.score=0}increaseScore(e){let t=1+Math.floor(this.timer.time/20);this.score+=e.scoreBase*t}draw(){this.ctx.font="40px Sans-serif",this.ctx.strokeStyle="black",this.ctx.lineWidth=8,this.ctx.fillStyle="yellow",this.ctx.strokeText("SCORE",this.dimensions.width/1.4,40),this.ctx.fillText("SCORE",this.dimensions.width/1.4,40),this.ctx.font="40px Sans-serif",this.ctx.strokeText(this.score,this.dimensions.width/1.1,40),this.ctx.fillText(this.score,this.dimensions.width/1.1,40)}}class m{constructor(e,t){this.ctx=e,this.dimensions=t,this.time=0,this.counter=this.startTimer()}startTimer(){return setInterval((()=>this.time+=1),1e3)}stopTimer(){clearInterval(this.counter)}draw(){this.ctx.font="40px Sans-serif",this.ctx.strokeStyle="black",this.ctx.lineWidth=8,this.ctx.fillStyle="yellow",this.ctx.strokeText("TIME",this.dimensions.width/2-10,40),this.ctx.fillText("TIME",this.dimensions.width/2-10,40),this.ctx.font="60px Sans-serif",this.ctx.strokeText(this.time,this.dimensions.width/2-10,100),this.ctx.fillText(this.time,this.dimensions.width/2-10,100)}}class p{constructor(e){this.game=e,this.dimensions=e.dimensions,this.floorHeight=e.dimensions.height/2.2,this.ctx=e.ctx,this.enemies=[],this.killed_characters=[],this.player=new c(e),this.timer=new m(this.ctx,this.dimensions),this.score=new _(this.ctx,this.dimensions,this.timer),this.addNewEnemies(),this.startMusic(),this.gameOver=!1}startMusic(){"on"===this.game.options.sound&&(this.sound=new Howl({src:["./sounds/The_Dark_Amulet.mp3"]}),this.sound.volume(.1*this.game.options.volume.BGM),this.sound.play())}stopMusic(){this.sound.stop()}draw(){if(this.flashScreen)this.ctx.fillStyle="white",this.ctx.fillRect(0,0,this.dimensions.width,this.dimensions.height),this.flashScreen=!1;else{var e=new Image;e.onload=()=>{this.ctx.drawImage(e,0,0,this.dimensions.width,this.dimensions.height)},e.src="./images/gameBackgrounds/stageBackground.png",this.player.drawCharacter(),this.player.lifebar.drawLifebar(),this.timer.draw(),this.score.draw(),this.enemies.forEach((e=>{e.drawCharacter(),e.lifebar.drawLifebar()})),this.killed_characters.forEach((e=>{e.drawCharacter(),e.lifebar.drawLifebar()})),this.gameOver&&(this.continueScreen||(this.continueScreen=new u(this.game)),this.continueScreen.draw())}}move(e){this.gameOver?(this.continueScreen||(this.continueScreen=new u(this.game)),this.continueScreen.move(e)):this.player.move(e)}performAction(e){this.gameOver?(this.continueScreen||(this.continueScreen=new u(this.game)),this.continueScreen.performAction(e)):this.player.performAction(e)}addNewEnemies(){let e=2+Math.floor(this.timer.time/20);for(;this.enemies.length<e;)this.generateEnemy()}generateEnemy(){let e=new l(this.game,this.getRandomStartPos());this.enemies.push(e)}getRandomStartPos(){return["left"==(1===Math.floor(2*Math.random())?"left":"right")?1e3:-100,Math.floor(Math.random()*(this.dimensions.height-this.floorHeight))+this.floorHeight]}checkAttacksLanded(){this.checkPlayerAttacks(),this.checkEnemyAttack()}checkKilledEnemies(){this.enemies.forEach(((e,t)=>{0===e.lifebar.health&&(this.enemies=this.enemies.slice(0,t).concat(this.enemies.slice(t+1)),this.killed_characters.push(e),setTimeout((()=>this.killed_characters.shift()),5e3),e.death(),this.score.increaseScore(e))}))}checkKilledPlayer(){0===this.player.lifebar.health&&"death"!==this.player.currentAction&&(this.killed_characters.push(this.player),setTimeout((()=>this.killed_characters.shift()),5e3),this.player.death(),this.gameOver=!0)}checkPlayerAttacks(){this.player.hitbox.length&&this.enemies.forEach((e=>{if(this.checkCollision(this.player.hitbox,e.calculateHurtBox()))switch(this.player.currentAction){case"lAttack":e.stunned||e.takeDamage(15);break;case"hAttack":e.takeDamage(30);break;case"throw":e.takeDamage(50)}}))}checkEnemyAttack(){this.enemies.forEach((e=>{this.checkCollision(e.hitbox,this.player.calculateHurtBox())&&(this.player.stunned||this.player.takeDamage(10))}))}checkCollision(e,t){return(e[0]<=t[0]&&e[2]>=t[0]||e[0]<=t[2]&&e[2]>=t[2])&&(e[1]>=t[1]&&e[3]<=t[1]||e[1]>=t[3]&&e[3]<=t[3])}startFlashScreen(){this.flashScreen=!0}}class f{constructor(e){this.ctx=e.getContext("2d"),this.dimensions={width:e.width,height:e.height},this.options=new o,this.startMenu(),this.controller={up:!1,down:!1,left:!1,right:!1,lAttack:!1,hAttack:!1,jump:!1,throw:!1},this.update(),this.ctx.webkitImageSmoothingEnabled=!1,this.ctx.imageSmoothingEnabled=!1}startMenu(){this.currentScreen=new a(this)}startInstructions(){this.currentScreen=new n(this)}startGame(){this.currentScreen=new p(this)}startDashTimeOut(){this.dashTimeOut=setTimeout((()=>{this.dashWindow=null}),2e3)}setKeyDown(e){"left"!==e&&"right"!==e||(this.dashWindow&&this.dashWindow.direction===e?this.dashWindow.numUp>0&&this.dashWindow.numDown++:(this.dashWindow={numDown:1,numUp:0,direction:e},this.startDashTimeOut())),this.controller[`${e}`]=!0}setKeyUp(e){"left"!==e&&"right"!==e||this.dashWindow&&this.dashWindow.direction===e&&(this.dashWindow.numUp++,this.dashWindow.numDown>=2&&this.dashWindow.numUp>=2&&this.currentScreen.constructor===p&&(this.currentScreen.player.dash(`${e}`),this.dashTimeOut=null)),this.controller[`${e}`]=!1}checkInputs(){let e={left:this.controller.left,up:this.controller.up,right:this.controller.right,down:this.controller.down},t={lAttack:this.controller.lAttack,hAttack:this.controller.hAttack,jump:this.controller.jump,throw:this.controller.throw};this.currentScreen.move(e),this.currentScreen.performAction(t)}update(){this.currentScreen.draw(this.ctx),this.checkInputs(),this.currentScreen.constructor===p&&(this.currentScreen.checkAttacksLanded(),this.currentScreen.checkKilledEnemies(),this.currentScreen.checkKilledPlayer(),this.currentScreen.addNewEnemies(),this.currentScreen.enemies.forEach((e=>e.determineNextAction()))),requestAnimationFrame(this.update.bind(this))}}document.addEventListener("DOMContentLoaded",(()=>{let e,t=document.querySelector(".background-container"),i=document.querySelector("#enter-checkbox"),n=document.createElement("img"),o=document.createElement("img"),s=document.createElement("img"),r=document.createElement("div"),a=document.querySelector(".mute-button");n.setAttribute("src","./images/mainPage/neon_enter_sign.gif"),o.setAttribute("src","./images/mainPage/neon_click_here.gif"),s.setAttribute("src","./images/mainPage/arcadeSign.gif"),n.classList.add("enter-sign"),s.classList.add("arcade-open-sign"),o.classList.add("click-here-sign"),r.classList.add("click-container"),t.appendChild(s),r.appendChild(n),r.appendChild(o),t.appendChild(r),a.addEventListener("click",(e=>{a.value})),r.addEventListener("click",(a=>{r.style.display="none",o.style.display="none",n.style.display="none",s.style.display="none",i.checked=!0,setTimeout((()=>{t.style.backgroundImage="url('./images/mainPage/arcade_screen_background.jpg')",t.style.backgroundSize="contain",document.querySelector(".canvas-container").style.display="flex";let n=document.getElementById("game-canvas");e=new f(n),i.checked=!1,document.addEventListener("keydown",(t=>{let i=Object.keys(e.options.controls).filter((i=>e.options.controls[i]===t.code));i.length&&e.setKeyDown(i[0])})),document.addEventListener("keyup",(t=>{let i=Object.keys(e.options.controls).filter((i=>e.options.controls[i]===t.code));i.length&&e.setKeyUp(i[0])}))}),5e3)}))}))}()}();
//# sourceMappingURL=main.js.map