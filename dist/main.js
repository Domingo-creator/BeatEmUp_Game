/*! For license information please see main.js.LICENSE.txt */
!function(){var e={766:function(e,t,n){var i;!function(){"use strict";var o=function(){this.init()};o.prototype={init:function(){var e=this||s;return e._counter=1e3,e._html5AudioPool=[],e.html5PoolSize=10,e._codecs={},e._howls=[],e._muted=!1,e._volume=1,e._canPlayEvent="canplaythrough",e._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,e.masterGain=null,e.noAudio=!1,e.usingWebAudio=!0,e.autoSuspend=!0,e.ctx=null,e.autoUnlock=!0,e._setup(),e},volume:function(e){var t=this||s;if(e=parseFloat(e),t.ctx||_(),void 0!==e&&e>=0&&e<=1){if(t._volume=e,t._muted)return t;t.usingWebAudio&&t.masterGain.gain.setValueAtTime(e,s.ctx.currentTime);for(var n=0;n<t._howls.length;n++)if(!t._howls[n]._webAudio)for(var i=t._howls[n]._getSoundIds(),o=0;o<i.length;o++){var r=t._howls[n]._soundById(i[o]);r&&r._node&&(r._node.volume=r._volume*e)}return t}return t._volume},mute:function(e){var t=this||s;t.ctx||_(),t._muted=e,t.usingWebAudio&&t.masterGain.gain.setValueAtTime(e?0:t._volume,s.ctx.currentTime);for(var n=0;n<t._howls.length;n++)if(!t._howls[n]._webAudio)for(var i=t._howls[n]._getSoundIds(),o=0;o<i.length;o++){var r=t._howls[n]._soundById(i[o]);r&&r._node&&(r._node.muted=!!e||r._muted)}return t},stop:function(){for(var e=this||s,t=0;t<e._howls.length;t++)e._howls[t].stop();return e},unload:function(){for(var e=this||s,t=e._howls.length-1;t>=0;t--)e._howls[t].unload();return e.usingWebAudio&&e.ctx&&void 0!==e.ctx.close&&(e.ctx.close(),e.ctx=null,_()),e},codecs:function(e){return(this||s)._codecs[e.replace(/^x-/,"")]},_setup:function(){var e=this||s;if(e.state=e.ctx&&e.ctx.state||"suspended",e._autoSuspend(),!e.usingWebAudio)if("undefined"!=typeof Audio)try{void 0===(new Audio).oncanplaythrough&&(e._canPlayEvent="canplay")}catch(t){e.noAudio=!0}else e.noAudio=!0;try{(new Audio).muted&&(e.noAudio=!0)}catch(e){}return e.noAudio||e._setupCodecs(),e},_setupCodecs:function(){var e=this||s,t=null;try{t="undefined"!=typeof Audio?new Audio:null}catch(t){return e}if(!t||"function"!=typeof t.canPlayType)return e;var n=t.canPlayType("audio/mpeg;").replace(/^no$/,""),i=e._navigator?e._navigator.userAgent:"",o=i.match(/OPR\/([0-6].)/g),r=o&&parseInt(o[0].split("/")[1],10)<33,a=-1!==i.indexOf("Safari")&&-1===i.indexOf("Chrome"),d=i.match(/Version\/(.*?) /),u=a&&d&&parseInt(d[1],10)<15;return e._codecs={mp3:!(r||!n&&!t.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!n,opus:!!t.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(t.canPlayType('audio/wav; codecs="1"')||t.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!t.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!t.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(t.canPlayType("audio/x-m4a;")||t.canPlayType("audio/m4a;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(t.canPlayType("audio/x-m4b;")||t.canPlayType("audio/m4b;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(t.canPlayType("audio/x-mp4;")||t.canPlayType("audio/mp4;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!(u||!t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!(u||!t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!t.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(t.canPlayType("audio/x-flac;")||t.canPlayType("audio/flac;")).replace(/^no$/,"")},e},_unlockAudio:function(){var e=this||s;if(!e._audioUnlocked&&e.ctx){e._audioUnlocked=!1,e.autoUnlock=!1,e._mobileUnloaded||44100===e.ctx.sampleRate||(e._mobileUnloaded=!0,e.unload()),e._scratchBuffer=e.ctx.createBuffer(1,1,22050);var t=function(n){for(;e._html5AudioPool.length<e.html5PoolSize;)try{var i=new Audio;i._unlocked=!0,e._releaseHtml5Audio(i)}catch(n){e.noAudio=!0;break}for(var o=0;o<e._howls.length;o++)if(!e._howls[o]._webAudio)for(var s=e._howls[o]._getSoundIds(),r=0;r<s.length;r++){var a=e._howls[o]._soundById(s[r]);a&&a._node&&!a._node._unlocked&&(a._node._unlocked=!0,a._node.load())}e._autoResume();var d=e.ctx.createBufferSource();d.buffer=e._scratchBuffer,d.connect(e.ctx.destination),void 0===d.start?d.noteOn(0):d.start(0),"function"==typeof e.ctx.resume&&e.ctx.resume(),d.onended=function(){d.disconnect(0),e._audioUnlocked=!0,document.removeEventListener("touchstart",t,!0),document.removeEventListener("touchend",t,!0),document.removeEventListener("click",t,!0),document.removeEventListener("keydown",t,!0);for(var n=0;n<e._howls.length;n++)e._howls[n]._emit("unlock")}};return document.addEventListener("touchstart",t,!0),document.addEventListener("touchend",t,!0),document.addEventListener("click",t,!0),document.addEventListener("keydown",t,!0),e}},_obtainHtml5Audio:function(){var e=this||s;if(e._html5AudioPool.length)return e._html5AudioPool.pop();var t=(new Audio).play();return t&&"undefined"!=typeof Promise&&(t instanceof Promise||"function"==typeof t.then)&&t.catch((function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")})),new Audio},_releaseHtml5Audio:function(e){var t=this||s;return e._unlocked&&t._html5AudioPool.push(e),t},_autoSuspend:function(){var e=this;if(e.autoSuspend&&e.ctx&&void 0!==e.ctx.suspend&&s.usingWebAudio){for(var t=0;t<e._howls.length;t++)if(e._howls[t]._webAudio)for(var n=0;n<e._howls[t]._sounds.length;n++)if(!e._howls[t]._sounds[n]._paused)return e;return e._suspendTimer&&clearTimeout(e._suspendTimer),e._suspendTimer=setTimeout((function(){if(e.autoSuspend){e._suspendTimer=null,e.state="suspending";var t=function(){e.state="suspended",e._resumeAfterSuspend&&(delete e._resumeAfterSuspend,e._autoResume())};e.ctx.suspend().then(t,t)}}),3e4),e}},_autoResume:function(){var e=this;if(e.ctx&&void 0!==e.ctx.resume&&s.usingWebAudio)return"running"===e.state&&"interrupted"!==e.ctx.state&&e._suspendTimer?(clearTimeout(e._suspendTimer),e._suspendTimer=null):"suspended"===e.state||"running"===e.state&&"interrupted"===e.ctx.state?(e.ctx.resume().then((function(){e.state="running";for(var t=0;t<e._howls.length;t++)e._howls[t]._emit("resume")})),e._suspendTimer&&(clearTimeout(e._suspendTimer),e._suspendTimer=null)):"suspending"===e.state&&(e._resumeAfterSuspend=!0),e}};var s=new o,r=function(e){e.src&&0!==e.src.length?this.init(e):console.error("An array of source files must be passed with any new Howl.")};r.prototype={init:function(e){var t=this;return s.ctx||_(),t._autoplay=e.autoplay||!1,t._format="string"!=typeof e.format?e.format:[e.format],t._html5=e.html5||!1,t._muted=e.mute||!1,t._loop=e.loop||!1,t._pool=e.pool||5,t._preload="boolean"!=typeof e.preload&&"metadata"!==e.preload||e.preload,t._rate=e.rate||1,t._sprite=e.sprite||{},t._src="string"!=typeof e.src?e.src:[e.src],t._volume=void 0!==e.volume?e.volume:1,t._xhr={method:e.xhr&&e.xhr.method?e.xhr.method:"GET",headers:e.xhr&&e.xhr.headers?e.xhr.headers:null,withCredentials:!(!e.xhr||!e.xhr.withCredentials)&&e.xhr.withCredentials},t._duration=0,t._state="unloaded",t._sounds=[],t._endTimers={},t._queue=[],t._playLock=!1,t._onend=e.onend?[{fn:e.onend}]:[],t._onfade=e.onfade?[{fn:e.onfade}]:[],t._onload=e.onload?[{fn:e.onload}]:[],t._onloaderror=e.onloaderror?[{fn:e.onloaderror}]:[],t._onplayerror=e.onplayerror?[{fn:e.onplayerror}]:[],t._onpause=e.onpause?[{fn:e.onpause}]:[],t._onplay=e.onplay?[{fn:e.onplay}]:[],t._onstop=e.onstop?[{fn:e.onstop}]:[],t._onmute=e.onmute?[{fn:e.onmute}]:[],t._onvolume=e.onvolume?[{fn:e.onvolume}]:[],t._onrate=e.onrate?[{fn:e.onrate}]:[],t._onseek=e.onseek?[{fn:e.onseek}]:[],t._onunlock=e.onunlock?[{fn:e.onunlock}]:[],t._onresume=[],t._webAudio=s.usingWebAudio&&!t._html5,void 0!==s.ctx&&s.ctx&&s.autoUnlock&&s._unlockAudio(),s._howls.push(t),t._autoplay&&t._queue.push({event:"play",action:function(){t.play()}}),t._preload&&"none"!==t._preload&&t.load(),t},load:function(){var e=this,t=null;if(s.noAudio)e._emit("loaderror",null,"No audio support.");else{"string"==typeof e._src&&(e._src=[e._src]);for(var n=0;n<e._src.length;n++){var i,o;if(e._format&&e._format[n])i=e._format[n];else{if("string"!=typeof(o=e._src[n])){e._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(i=/^data:audio\/([^;,]+);/i.exec(o))||(i=/\.([^.]+)$/.exec(o.split("?",1)[0])),i&&(i=i[1].toLowerCase())}if(i||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),i&&s.codecs(i)){t=e._src[n];break}}if(t)return e._src=t,e._state="loading","https:"===window.location.protocol&&"http:"===t.slice(0,5)&&(e._html5=!0,e._webAudio=!1),new a(e),e._webAudio&&u(e),e;e._emit("loaderror",null,"No codec support for selected audio sources.")}},play:function(e,t){var n=this,i=null;if("number"==typeof e)i=e,e=null;else{if("string"==typeof e&&"loaded"===n._state&&!n._sprite[e])return null;if(void 0===e&&(e="__default",!n._playLock)){for(var o=0,r=0;r<n._sounds.length;r++)n._sounds[r]._paused&&!n._sounds[r]._ended&&(o++,i=n._sounds[r]._id);1===o?e=null:i=null}}var a=i?n._soundById(i):n._inactiveSound();if(!a)return null;if(i&&!e&&(e=a._sprite||"__default"),"loaded"!==n._state){a._sprite=e,a._ended=!1;var d=a._id;return n._queue.push({event:"play",action:function(){n.play(d)}}),d}if(i&&!a._paused)return t||n._loadQueue("play"),a._id;n._webAudio&&s._autoResume();var u=Math.max(0,a._seek>0?a._seek:n._sprite[e][0]/1e3),h=Math.max(0,(n._sprite[e][0]+n._sprite[e][1])/1e3-u),l=1e3*h/Math.abs(a._rate),c=n._sprite[e][0]/1e3,_=(n._sprite[e][0]+n._sprite[e][1])/1e3;a._sprite=e,a._ended=!1;var p=function(){a._paused=!1,a._seek=u,a._start=c,a._stop=_,a._loop=!(!a._loop&&!n._sprite[e][2])};if(!(u>=_)){var m=a._node;if(n._webAudio){var f=function(){n._playLock=!1,p(),n._refreshBuffer(a);var e=a._muted||n._muted?0:a._volume;m.gain.setValueAtTime(e,s.ctx.currentTime),a._playStart=s.ctx.currentTime,void 0===m.bufferSource.start?a._loop?m.bufferSource.noteGrainOn(0,u,86400):m.bufferSource.noteGrainOn(0,u,h):a._loop?m.bufferSource.start(0,u,86400):m.bufferSource.start(0,u,h),l!==1/0&&(n._endTimers[a._id]=setTimeout(n._ended.bind(n,a),l)),t||setTimeout((function(){n._emit("play",a._id),n._loadQueue()}),0)};"running"===s.state&&"interrupted"!==s.ctx.state?f():(n._playLock=!0,n.once("resume",f),n._clearTimer(a._id))}else{var g=function(){m.currentTime=u,m.muted=a._muted||n._muted||s._muted||m.muted,m.volume=a._volume*s.volume(),m.playbackRate=a._rate;try{var i=m.play();if(i&&"undefined"!=typeof Promise&&(i instanceof Promise||"function"==typeof i.then)?(n._playLock=!0,p(),i.then((function(){n._playLock=!1,m._unlocked=!0,t?n._loadQueue():n._emit("play",a._id)})).catch((function(){n._playLock=!1,n._emit("playerror",a._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),a._ended=!0,a._paused=!0}))):t||(n._playLock=!1,p(),n._emit("play",a._id)),m.playbackRate=a._rate,m.paused)return void n._emit("playerror",a._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");"__default"!==e||a._loop?n._endTimers[a._id]=setTimeout(n._ended.bind(n,a),l):(n._endTimers[a._id]=function(){n._ended(a),m.removeEventListener("ended",n._endTimers[a._id],!1)},m.addEventListener("ended",n._endTimers[a._id],!1))}catch(e){n._emit("playerror",a._id,e)}};"data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"===m.src&&(m.src=n._src,m.load());var w=window&&window.ejecta||!m.readyState&&s._navigator.isCocoonJS;if(m.readyState>=3||w)g();else{n._playLock=!0,n._state="loading";var y=function(){n._state="loaded",g(),m.removeEventListener(s._canPlayEvent,y,!1)};m.addEventListener(s._canPlayEvent,y,!1),n._clearTimer(a._id)}}return a._id}n._ended(a)},pause:function(e){var t=this;if("loaded"!==t._state||t._playLock)return t._queue.push({event:"pause",action:function(){t.pause(e)}}),t;for(var n=t._getSoundIds(e),i=0;i<n.length;i++){t._clearTimer(n[i]);var o=t._soundById(n[i]);if(o&&!o._paused&&(o._seek=t.seek(n[i]),o._rateSeek=0,o._paused=!0,t._stopFade(n[i]),o._node))if(t._webAudio){if(!o._node.bufferSource)continue;void 0===o._node.bufferSource.stop?o._node.bufferSource.noteOff(0):o._node.bufferSource.stop(0),t._cleanBuffer(o._node)}else isNaN(o._node.duration)&&o._node.duration!==1/0||o._node.pause();arguments[1]||t._emit("pause",o?o._id:null)}return t},stop:function(e,t){var n=this;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"stop",action:function(){n.stop(e)}}),n;for(var i=n._getSoundIds(e),o=0;o<i.length;o++){n._clearTimer(i[o]);var s=n._soundById(i[o]);s&&(s._seek=s._start||0,s._rateSeek=0,s._paused=!0,s._ended=!0,n._stopFade(i[o]),s._node&&(n._webAudio?s._node.bufferSource&&(void 0===s._node.bufferSource.stop?s._node.bufferSource.noteOff(0):s._node.bufferSource.stop(0),n._cleanBuffer(s._node)):isNaN(s._node.duration)&&s._node.duration!==1/0||(s._node.currentTime=s._start||0,s._node.pause(),s._node.duration===1/0&&n._clearSound(s._node))),t||n._emit("stop",s._id))}return n},mute:function(e,t){var n=this;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"mute",action:function(){n.mute(e,t)}}),n;if(void 0===t){if("boolean"!=typeof e)return n._muted;n._muted=e}for(var i=n._getSoundIds(t),o=0;o<i.length;o++){var r=n._soundById(i[o]);r&&(r._muted=e,r._interval&&n._stopFade(r._id),n._webAudio&&r._node?r._node.gain.setValueAtTime(e?0:r._volume,s.ctx.currentTime):r._node&&(r._node.muted=!!s._muted||e),n._emit("mute",r._id))}return n},volume:function(){var e,t,n,i=this,o=arguments;if(0===o.length)return i._volume;if(1===o.length||2===o.length&&void 0===o[1]){var r=i._getSoundIds(),a=r.indexOf(o[0]);a>=0?t=parseInt(o[0],10):e=parseFloat(o[0])}else o.length>=2&&(e=parseFloat(o[0]),t=parseInt(o[1],10));if(!(void 0!==e&&e>=0&&e<=1))return(n=t?i._soundById(t):i._sounds[0])?n._volume:0;if("loaded"!==i._state||i._playLock)return i._queue.push({event:"volume",action:function(){i.volume.apply(i,o)}}),i;void 0===t&&(i._volume=e),t=i._getSoundIds(t);for(var d=0;d<t.length;d++)(n=i._soundById(t[d]))&&(n._volume=e,o[2]||i._stopFade(t[d]),i._webAudio&&n._node&&!n._muted?n._node.gain.setValueAtTime(e,s.ctx.currentTime):n._node&&!n._muted&&(n._node.volume=e*s.volume()),i._emit("volume",n._id));return i},fade:function(e,t,n,i){var o=this;if("loaded"!==o._state||o._playLock)return o._queue.push({event:"fade",action:function(){o.fade(e,t,n,i)}}),o;e=Math.min(Math.max(0,parseFloat(e)),1),t=Math.min(Math.max(0,parseFloat(t)),1),n=parseFloat(n),o.volume(e,i);for(var r=o._getSoundIds(i),a=0;a<r.length;a++){var d=o._soundById(r[a]);if(d){if(i||o._stopFade(r[a]),o._webAudio&&!d._muted){var u=s.ctx.currentTime,h=u+n/1e3;d._volume=e,d._node.gain.setValueAtTime(e,u),d._node.gain.linearRampToValueAtTime(t,h)}o._startFadeInterval(d,e,t,n,r[a],void 0===i)}}return o},_startFadeInterval:function(e,t,n,i,o,s){var r=this,a=t,d=n-t,u=Math.abs(d/.01),h=Math.max(4,u>0?i/u:i),l=Date.now();e._fadeTo=n,e._interval=setInterval((function(){var o=(Date.now()-l)/i;l=Date.now(),a+=d*o,a=Math.round(100*a)/100,a=d<0?Math.max(n,a):Math.min(n,a),r._webAudio?e._volume=a:r.volume(a,e._id,!0),s&&(r._volume=a),(n<t&&a<=n||n>t&&a>=n)&&(clearInterval(e._interval),e._interval=null,e._fadeTo=null,r.volume(n,e._id),r._emit("fade",e._id))}),h)},_stopFade:function(e){var t=this,n=t._soundById(e);return n&&n._interval&&(t._webAudio&&n._node.gain.cancelScheduledValues(s.ctx.currentTime),clearInterval(n._interval),n._interval=null,t.volume(n._fadeTo,e),n._fadeTo=null,t._emit("fade",e)),t},loop:function(){var e,t,n,i=this,o=arguments;if(0===o.length)return i._loop;if(1===o.length){if("boolean"!=typeof o[0])return!!(n=i._soundById(parseInt(o[0],10)))&&n._loop;e=o[0],i._loop=e}else 2===o.length&&(e=o[0],t=parseInt(o[1],10));for(var s=i._getSoundIds(t),r=0;r<s.length;r++)(n=i._soundById(s[r]))&&(n._loop=e,i._webAudio&&n._node&&n._node.bufferSource&&(n._node.bufferSource.loop=e,e&&(n._node.bufferSource.loopStart=n._start||0,n._node.bufferSource.loopEnd=n._stop,i.playing(s[r])&&(i.pause(s[r],!0),i.play(s[r],!0)))));return i},rate:function(){var e,t,n,i=this,o=arguments;if(0===o.length)t=i._sounds[0]._id;else if(1===o.length){var r=i._getSoundIds(),a=r.indexOf(o[0]);a>=0?t=parseInt(o[0],10):e=parseFloat(o[0])}else 2===o.length&&(e=parseFloat(o[0]),t=parseInt(o[1],10));if("number"!=typeof e)return(n=i._soundById(t))?n._rate:i._rate;if("loaded"!==i._state||i._playLock)return i._queue.push({event:"rate",action:function(){i.rate.apply(i,o)}}),i;void 0===t&&(i._rate=e),t=i._getSoundIds(t);for(var d=0;d<t.length;d++)if(n=i._soundById(t[d])){i.playing(t[d])&&(n._rateSeek=i.seek(t[d]),n._playStart=i._webAudio?s.ctx.currentTime:n._playStart),n._rate=e,i._webAudio&&n._node&&n._node.bufferSource?n._node.bufferSource.playbackRate.setValueAtTime(e,s.ctx.currentTime):n._node&&(n._node.playbackRate=e);var u=i.seek(t[d]),h=(i._sprite[n._sprite][0]+i._sprite[n._sprite][1])/1e3-u,l=1e3*h/Math.abs(n._rate);!i._endTimers[t[d]]&&n._paused||(i._clearTimer(t[d]),i._endTimers[t[d]]=setTimeout(i._ended.bind(i,n),l)),i._emit("rate",n._id)}return i},seek:function(){var e,t,n=this,i=arguments;if(0===i.length)n._sounds.length&&(t=n._sounds[0]._id);else if(1===i.length){var o=n._getSoundIds(),r=o.indexOf(i[0]);r>=0?t=parseInt(i[0],10):n._sounds.length&&(t=n._sounds[0]._id,e=parseFloat(i[0]))}else 2===i.length&&(e=parseFloat(i[0]),t=parseInt(i[1],10));if(void 0===t)return 0;if("number"==typeof e&&("loaded"!==n._state||n._playLock))return n._queue.push({event:"seek",action:function(){n.seek.apply(n,i)}}),n;var a=n._soundById(t);if(a){if(!("number"==typeof e&&e>=0)){if(n._webAudio){var d=n.playing(t)?s.ctx.currentTime-a._playStart:0,u=a._rateSeek?a._rateSeek-a._seek:0;return a._seek+(u+d*Math.abs(a._rate))}return a._node.currentTime}var h=n.playing(t);h&&n.pause(t,!0),a._seek=e,a._ended=!1,n._clearTimer(t),n._webAudio||!a._node||isNaN(a._node.duration)||(a._node.currentTime=e);var l=function(){h&&n.play(t,!0),n._emit("seek",t)};if(h&&!n._webAudio){var c=function(){n._playLock?setTimeout(c,0):l()};setTimeout(c,0)}else l()}return n},playing:function(e){var t=this;if("number"==typeof e){var n=t._soundById(e);return!!n&&!n._paused}for(var i=0;i<t._sounds.length;i++)if(!t._sounds[i]._paused)return!0;return!1},duration:function(e){var t=this,n=t._duration,i=t._soundById(e);return i&&(n=t._sprite[i._sprite][1]/1e3),n},state:function(){return this._state},unload:function(){for(var e=this,t=e._sounds,n=0;n<t.length;n++)t[n]._paused||e.stop(t[n]._id),e._webAudio||(e._clearSound(t[n]._node),t[n]._node.removeEventListener("error",t[n]._errorFn,!1),t[n]._node.removeEventListener(s._canPlayEvent,t[n]._loadFn,!1),t[n]._node.removeEventListener("ended",t[n]._endFn,!1),s._releaseHtml5Audio(t[n]._node)),delete t[n]._node,e._clearTimer(t[n]._id);var i=s._howls.indexOf(e);i>=0&&s._howls.splice(i,1);var o=!0;for(n=0;n<s._howls.length;n++)if(s._howls[n]._src===e._src||e._src.indexOf(s._howls[n]._src)>=0){o=!1;break}return d&&o&&delete d[e._src],s.noAudio=!1,e._state="unloaded",e._sounds=[],e=null,null},on:function(e,t,n,i){var o=this["_on"+e];return"function"==typeof t&&o.push(i?{id:n,fn:t,once:i}:{id:n,fn:t}),this},off:function(e,t,n){var i=this,o=i["_on"+e],s=0;if("number"==typeof t&&(n=t,t=null),t||n)for(s=0;s<o.length;s++){var r=n===o[s].id;if(t===o[s].fn&&r||!t&&r){o.splice(s,1);break}}else if(e)i["_on"+e]=[];else{var a=Object.keys(i);for(s=0;s<a.length;s++)0===a[s].indexOf("_on")&&Array.isArray(i[a[s]])&&(i[a[s]]=[])}return i},once:function(e,t,n){return this.on(e,t,n,1),this},_emit:function(e,t,n){for(var i=this,o=i["_on"+e],s=o.length-1;s>=0;s--)o[s].id&&o[s].id!==t&&"load"!==e||(setTimeout(function(e){e.call(this,t,n)}.bind(i,o[s].fn),0),o[s].once&&i.off(e,o[s].fn,o[s].id));return i._loadQueue(e),i},_loadQueue:function(e){var t=this;if(t._queue.length>0){var n=t._queue[0];n.event===e&&(t._queue.shift(),t._loadQueue()),e||n.action()}return t},_ended:function(e){var t=this,n=e._sprite;if(!t._webAudio&&e._node&&!e._node.paused&&!e._node.ended&&e._node.currentTime<e._stop)return setTimeout(t._ended.bind(t,e),100),t;var i=!(!e._loop&&!t._sprite[n][2]);if(t._emit("end",e._id),!t._webAudio&&i&&t.stop(e._id,!0).play(e._id),t._webAudio&&i){t._emit("play",e._id),e._seek=e._start||0,e._rateSeek=0,e._playStart=s.ctx.currentTime;var o=1e3*(e._stop-e._start)/Math.abs(e._rate);t._endTimers[e._id]=setTimeout(t._ended.bind(t,e),o)}return t._webAudio&&!i&&(e._paused=!0,e._ended=!0,e._seek=e._start||0,e._rateSeek=0,t._clearTimer(e._id),t._cleanBuffer(e._node),s._autoSuspend()),t._webAudio||i||t.stop(e._id,!0),t},_clearTimer:function(e){var t=this;if(t._endTimers[e]){if("function"!=typeof t._endTimers[e])clearTimeout(t._endTimers[e]);else{var n=t._soundById(e);n&&n._node&&n._node.removeEventListener("ended",t._endTimers[e],!1)}delete t._endTimers[e]}return t},_soundById:function(e){for(var t=this,n=0;n<t._sounds.length;n++)if(e===t._sounds[n]._id)return t._sounds[n];return null},_inactiveSound:function(){var e=this;e._drain();for(var t=0;t<e._sounds.length;t++)if(e._sounds[t]._ended)return e._sounds[t].reset();return new a(e)},_drain:function(){var e=this,t=e._pool,n=0,i=0;if(!(e._sounds.length<t)){for(i=0;i<e._sounds.length;i++)e._sounds[i]._ended&&n++;for(i=e._sounds.length-1;i>=0;i--){if(n<=t)return;e._sounds[i]._ended&&(e._webAudio&&e._sounds[i]._node&&e._sounds[i]._node.disconnect(0),e._sounds.splice(i,1),n--)}}},_getSoundIds:function(e){if(void 0===e){for(var t=[],n=0;n<this._sounds.length;n++)t.push(this._sounds[n]._id);return t}return[e]},_refreshBuffer:function(e){return e._node.bufferSource=s.ctx.createBufferSource(),e._node.bufferSource.buffer=d[this._src],e._panner?e._node.bufferSource.connect(e._panner):e._node.bufferSource.connect(e._node),e._node.bufferSource.loop=e._loop,e._loop&&(e._node.bufferSource.loopStart=e._start||0,e._node.bufferSource.loopEnd=e._stop||0),e._node.bufferSource.playbackRate.setValueAtTime(e._rate,s.ctx.currentTime),this},_cleanBuffer:function(e){var t=s._navigator&&s._navigator.vendor.indexOf("Apple")>=0;if(s._scratchBuffer&&e.bufferSource&&(e.bufferSource.onended=null,e.bufferSource.disconnect(0),t))try{e.bufferSource.buffer=s._scratchBuffer}catch(e){}return e.bufferSource=null,this},_clearSound:function(e){/MSIE |Trident\//.test(s._navigator&&s._navigator.userAgent)||(e.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var a=function(e){this._parent=e,this.init()};a.prototype={init:function(){var e=this,t=e._parent;return e._muted=t._muted,e._loop=t._loop,e._volume=t._volume,e._rate=t._rate,e._seek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++s._counter,t._sounds.push(e),e.create(),e},create:function(){var e=this,t=e._parent,n=s._muted||e._muted||e._parent._muted?0:e._volume;return t._webAudio?(e._node=void 0===s.ctx.createGain?s.ctx.createGainNode():s.ctx.createGain(),e._node.gain.setValueAtTime(n,s.ctx.currentTime),e._node.paused=!0,e._node.connect(s.masterGain)):s.noAudio||(e._node=s._obtainHtml5Audio(),e._errorFn=e._errorListener.bind(e),e._node.addEventListener("error",e._errorFn,!1),e._loadFn=e._loadListener.bind(e),e._node.addEventListener(s._canPlayEvent,e._loadFn,!1),e._endFn=e._endListener.bind(e),e._node.addEventListener("ended",e._endFn,!1),e._node.src=t._src,e._node.preload=!0===t._preload?"auto":t._preload,e._node.volume=n*s.volume(),e._node.load()),e},reset:function(){var e=this,t=e._parent;return e._muted=t._muted,e._loop=t._loop,e._volume=t._volume,e._rate=t._rate,e._seek=0,e._rateSeek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++s._counter,e},_errorListener:function(){var e=this;e._parent._emit("loaderror",e._id,e._node.error?e._node.error.code:0),e._node.removeEventListener("error",e._errorFn,!1)},_loadListener:function(){var e=this,t=e._parent;t._duration=Math.ceil(10*e._node.duration)/10,0===Object.keys(t._sprite).length&&(t._sprite={__default:[0,1e3*t._duration]}),"loaded"!==t._state&&(t._state="loaded",t._emit("load"),t._loadQueue()),e._node.removeEventListener(s._canPlayEvent,e._loadFn,!1)},_endListener:function(){var e=this,t=e._parent;t._duration===1/0&&(t._duration=Math.ceil(10*e._node.duration)/10,t._sprite.__default[1]===1/0&&(t._sprite.__default[1]=1e3*t._duration),t._ended(e)),e._node.removeEventListener("ended",e._endFn,!1)}};var d={},u=function(e){var t=e._src;if(d[t])return e._duration=d[t].duration,void c(e);if(/^data:[^;]+;base64,/.test(t)){for(var n=atob(t.split(",")[1]),i=new Uint8Array(n.length),o=0;o<n.length;++o)i[o]=n.charCodeAt(o);l(i.buffer,e)}else{var s=new XMLHttpRequest;s.open(e._xhr.method,t,!0),s.withCredentials=e._xhr.withCredentials,s.responseType="arraybuffer",e._xhr.headers&&Object.keys(e._xhr.headers).forEach((function(t){s.setRequestHeader(t,e._xhr.headers[t])})),s.onload=function(){var t=(s.status+"")[0];"0"===t||"2"===t||"3"===t?l(s.response,e):e._emit("loaderror",null,"Failed loading audio file with status: "+s.status+".")},s.onerror=function(){e._webAudio&&(e._html5=!0,e._webAudio=!1,e._sounds=[],delete d[t],e.load())},h(s)}},h=function(e){try{e.send()}catch(t){e.onerror()}},l=function(e,t){var n=function(){t._emit("loaderror",null,"Decoding audio data failed.")},i=function(e){e&&t._sounds.length>0?(d[t._src]=e,c(t,e)):n()};"undefined"!=typeof Promise&&1===s.ctx.decodeAudioData.length?s.ctx.decodeAudioData(e).then(i).catch(n):s.ctx.decodeAudioData(e,i,n)},c=function(e,t){t&&!e._duration&&(e._duration=t.duration),0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),"loaded"!==e._state&&(e._state="loaded",e._emit("load"),e._loadQueue())},_=function(){if(s.usingWebAudio){try{"undefined"!=typeof AudioContext?s.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?s.ctx=new webkitAudioContext:s.usingWebAudio=!1}catch(e){s.usingWebAudio=!1}s.ctx||(s.usingWebAudio=!1);var e=/iP(hone|od|ad)/.test(s._navigator&&s._navigator.platform),t=s._navigator&&s._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),n=t?parseInt(t[1],10):null;if(e&&n&&n<9){var i=/safari/.test(s._navigator&&s._navigator.userAgent.toLowerCase());s._navigator&&!i&&(s.usingWebAudio=!1)}s.usingWebAudio&&(s.masterGain=void 0===s.ctx.createGain?s.ctx.createGainNode():s.ctx.createGain(),s.masterGain.gain.setValueAtTime(s._muted?0:s._volume,s.ctx.currentTime),s.masterGain.connect(s.ctx.destination)),s._setup()}};void 0===(i=function(){return{Howler:s,Howl:r}}.apply(t,[]))||(e.exports=i),t.Howler=s,t.Howl=r,void 0!==n.g?(n.g.HowlerGlobal=o,n.g.Howler=s,n.g.Howl=r,n.g.Sound=a):"undefined"!=typeof window&&(window.HowlerGlobal=o,window.Howler=s,window.Howl=r,window.Sound=a)}(),function(){"use strict";var e;HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(e){var t=this;if(!t.ctx||!t.ctx.listener)return t;for(var n=t._howls.length-1;n>=0;n--)t._howls[n].stereo(e);return t},HowlerGlobal.prototype.pos=function(e,t,n){var i=this;return i.ctx&&i.ctx.listener?(t="number"!=typeof t?i._pos[1]:t,n="number"!=typeof n?i._pos[2]:n,"number"!=typeof e?i._pos:(i._pos=[e,t,n],void 0!==i.ctx.listener.positionX?(i.ctx.listener.positionX.setTargetAtTime(i._pos[0],Howler.ctx.currentTime,.1),i.ctx.listener.positionY.setTargetAtTime(i._pos[1],Howler.ctx.currentTime,.1),i.ctx.listener.positionZ.setTargetAtTime(i._pos[2],Howler.ctx.currentTime,.1)):i.ctx.listener.setPosition(i._pos[0],i._pos[1],i._pos[2]),i)):i},HowlerGlobal.prototype.orientation=function(e,t,n,i,o,s){var r=this;if(!r.ctx||!r.ctx.listener)return r;var a=r._orientation;return t="number"!=typeof t?a[1]:t,n="number"!=typeof n?a[2]:n,i="number"!=typeof i?a[3]:i,o="number"!=typeof o?a[4]:o,s="number"!=typeof s?a[5]:s,"number"!=typeof e?a:(r._orientation=[e,t,n,i,o,s],void 0!==r.ctx.listener.forwardX?(r.ctx.listener.forwardX.setTargetAtTime(e,Howler.ctx.currentTime,.1),r.ctx.listener.forwardY.setTargetAtTime(t,Howler.ctx.currentTime,.1),r.ctx.listener.forwardZ.setTargetAtTime(n,Howler.ctx.currentTime,.1),r.ctx.listener.upX.setTargetAtTime(i,Howler.ctx.currentTime,.1),r.ctx.listener.upY.setTargetAtTime(o,Howler.ctx.currentTime,.1),r.ctx.listener.upZ.setTargetAtTime(s,Howler.ctx.currentTime,.1)):r.ctx.listener.setOrientation(e,t,n,i,o,s),r)},Howl.prototype.init=(e=Howl.prototype.init,function(t){var n=this;return n._orientation=t.orientation||[1,0,0],n._stereo=t.stereo||null,n._pos=t.pos||null,n._pannerAttr={coneInnerAngle:void 0!==t.coneInnerAngle?t.coneInnerAngle:360,coneOuterAngle:void 0!==t.coneOuterAngle?t.coneOuterAngle:360,coneOuterGain:void 0!==t.coneOuterGain?t.coneOuterGain:0,distanceModel:void 0!==t.distanceModel?t.distanceModel:"inverse",maxDistance:void 0!==t.maxDistance?t.maxDistance:1e4,panningModel:void 0!==t.panningModel?t.panningModel:"HRTF",refDistance:void 0!==t.refDistance?t.refDistance:1,rolloffFactor:void 0!==t.rolloffFactor?t.rolloffFactor:1},n._onstereo=t.onstereo?[{fn:t.onstereo}]:[],n._onpos=t.onpos?[{fn:t.onpos}]:[],n._onorientation=t.onorientation?[{fn:t.onorientation}]:[],e.call(this,t)}),Howl.prototype.stereo=function(e,n){var i=this;if(!i._webAudio)return i;if("loaded"!==i._state)return i._queue.push({event:"stereo",action:function(){i.stereo(e,n)}}),i;var o=void 0===Howler.ctx.createStereoPanner?"spatial":"stereo";if(void 0===n){if("number"!=typeof e)return i._stereo;i._stereo=e,i._pos=[e,0,0]}for(var s=i._getSoundIds(n),r=0;r<s.length;r++){var a=i._soundById(s[r]);if(a){if("number"!=typeof e)return a._stereo;a._stereo=e,a._pos=[e,0,0],a._node&&(a._pannerAttr.panningModel="equalpower",a._panner&&a._panner.pan||t(a,o),"spatial"===o?void 0!==a._panner.positionX?(a._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),a._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),a._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):a._panner.setPosition(e,0,0):a._panner.pan.setValueAtTime(e,Howler.ctx.currentTime)),i._emit("stereo",a._id)}}return i},Howl.prototype.pos=function(e,n,i,o){var s=this;if(!s._webAudio)return s;if("loaded"!==s._state)return s._queue.push({event:"pos",action:function(){s.pos(e,n,i,o)}}),s;if(n="number"!=typeof n?0:n,i="number"!=typeof i?-.5:i,void 0===o){if("number"!=typeof e)return s._pos;s._pos=[e,n,i]}for(var r=s._getSoundIds(o),a=0;a<r.length;a++){var d=s._soundById(r[a]);if(d){if("number"!=typeof e)return d._pos;d._pos=[e,n,i],d._node&&(d._panner&&!d._panner.pan||t(d,"spatial"),void 0!==d._panner.positionX?(d._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),d._panner.positionY.setValueAtTime(n,Howler.ctx.currentTime),d._panner.positionZ.setValueAtTime(i,Howler.ctx.currentTime)):d._panner.setPosition(e,n,i)),s._emit("pos",d._id)}}return s},Howl.prototype.orientation=function(e,n,i,o){var s=this;if(!s._webAudio)return s;if("loaded"!==s._state)return s._queue.push({event:"orientation",action:function(){s.orientation(e,n,i,o)}}),s;if(n="number"!=typeof n?s._orientation[1]:n,i="number"!=typeof i?s._orientation[2]:i,void 0===o){if("number"!=typeof e)return s._orientation;s._orientation=[e,n,i]}for(var r=s._getSoundIds(o),a=0;a<r.length;a++){var d=s._soundById(r[a]);if(d){if("number"!=typeof e)return d._orientation;d._orientation=[e,n,i],d._node&&(d._panner||(d._pos||(d._pos=s._pos||[0,0,-.5]),t(d,"spatial")),void 0!==d._panner.orientationX?(d._panner.orientationX.setValueAtTime(e,Howler.ctx.currentTime),d._panner.orientationY.setValueAtTime(n,Howler.ctx.currentTime),d._panner.orientationZ.setValueAtTime(i,Howler.ctx.currentTime)):d._panner.setOrientation(e,n,i)),s._emit("orientation",d._id)}}return s},Howl.prototype.pannerAttr=function(){var e,n,i,o=this,s=arguments;if(!o._webAudio)return o;if(0===s.length)return o._pannerAttr;if(1===s.length){if("object"!=typeof s[0])return(i=o._soundById(parseInt(s[0],10)))?i._pannerAttr:o._pannerAttr;e=s[0],void 0===n&&(e.pannerAttr||(e.pannerAttr={coneInnerAngle:e.coneInnerAngle,coneOuterAngle:e.coneOuterAngle,coneOuterGain:e.coneOuterGain,distanceModel:e.distanceModel,maxDistance:e.maxDistance,refDistance:e.refDistance,rolloffFactor:e.rolloffFactor,panningModel:e.panningModel}),o._pannerAttr={coneInnerAngle:void 0!==e.pannerAttr.coneInnerAngle?e.pannerAttr.coneInnerAngle:o._coneInnerAngle,coneOuterAngle:void 0!==e.pannerAttr.coneOuterAngle?e.pannerAttr.coneOuterAngle:o._coneOuterAngle,coneOuterGain:void 0!==e.pannerAttr.coneOuterGain?e.pannerAttr.coneOuterGain:o._coneOuterGain,distanceModel:void 0!==e.pannerAttr.distanceModel?e.pannerAttr.distanceModel:o._distanceModel,maxDistance:void 0!==e.pannerAttr.maxDistance?e.pannerAttr.maxDistance:o._maxDistance,refDistance:void 0!==e.pannerAttr.refDistance?e.pannerAttr.refDistance:o._refDistance,rolloffFactor:void 0!==e.pannerAttr.rolloffFactor?e.pannerAttr.rolloffFactor:o._rolloffFactor,panningModel:void 0!==e.pannerAttr.panningModel?e.pannerAttr.panningModel:o._panningModel})}else 2===s.length&&(e=s[0],n=parseInt(s[1],10));for(var r=o._getSoundIds(n),a=0;a<r.length;a++)if(i=o._soundById(r[a])){var d=i._pannerAttr;d={coneInnerAngle:void 0!==e.coneInnerAngle?e.coneInnerAngle:d.coneInnerAngle,coneOuterAngle:void 0!==e.coneOuterAngle?e.coneOuterAngle:d.coneOuterAngle,coneOuterGain:void 0!==e.coneOuterGain?e.coneOuterGain:d.coneOuterGain,distanceModel:void 0!==e.distanceModel?e.distanceModel:d.distanceModel,maxDistance:void 0!==e.maxDistance?e.maxDistance:d.maxDistance,refDistance:void 0!==e.refDistance?e.refDistance:d.refDistance,rolloffFactor:void 0!==e.rolloffFactor?e.rolloffFactor:d.rolloffFactor,panningModel:void 0!==e.panningModel?e.panningModel:d.panningModel};var u=i._panner;u?(u.coneInnerAngle=d.coneInnerAngle,u.coneOuterAngle=d.coneOuterAngle,u.coneOuterGain=d.coneOuterGain,u.distanceModel=d.distanceModel,u.maxDistance=d.maxDistance,u.refDistance=d.refDistance,u.rolloffFactor=d.rolloffFactor,u.panningModel=d.panningModel):(i._pos||(i._pos=o._pos||[0,0,-.5]),t(i,"spatial"))}return o},Sound.prototype.init=function(e){return function(){var t=this,n=t._parent;t._orientation=n._orientation,t._stereo=n._stereo,t._pos=n._pos,t._pannerAttr=n._pannerAttr,e.call(this),t._stereo?n.stereo(t._stereo):t._pos&&n.pos(t._pos[0],t._pos[1],t._pos[2],t._id)}}(Sound.prototype.init),Sound.prototype.reset=function(e){return function(){var t=this,n=t._parent;return t._orientation=n._orientation,t._stereo=n._stereo,t._pos=n._pos,t._pannerAttr=n._pannerAttr,t._stereo?n.stereo(t._stereo):t._pos?n.pos(t._pos[0],t._pos[1],t._pos[2],t._id):t._panner&&(t._panner.disconnect(0),t._panner=void 0,n._refreshBuffer(t)),e.call(this)}}(Sound.prototype.reset);var t=function(e,t){"spatial"===(t=t||"spatial")?(e._panner=Howler.ctx.createPanner(),e._panner.coneInnerAngle=e._pannerAttr.coneInnerAngle,e._panner.coneOuterAngle=e._pannerAttr.coneOuterAngle,e._panner.coneOuterGain=e._pannerAttr.coneOuterGain,e._panner.distanceModel=e._pannerAttr.distanceModel,e._panner.maxDistance=e._pannerAttr.maxDistance,e._panner.refDistance=e._pannerAttr.refDistance,e._panner.rolloffFactor=e._pannerAttr.rolloffFactor,e._panner.panningModel=e._pannerAttr.panningModel,void 0!==e._panner.positionX?(e._panner.positionX.setValueAtTime(e._pos[0],Howler.ctx.currentTime),e._panner.positionY.setValueAtTime(e._pos[1],Howler.ctx.currentTime),e._panner.positionZ.setValueAtTime(e._pos[2],Howler.ctx.currentTime)):e._panner.setPosition(e._pos[0],e._pos[1],e._pos[2]),void 0!==e._panner.orientationX?(e._panner.orientationX.setValueAtTime(e._orientation[0],Howler.ctx.currentTime),e._panner.orientationY.setValueAtTime(e._orientation[1],Howler.ctx.currentTime),e._panner.orientationZ.setValueAtTime(e._orientation[2],Howler.ctx.currentTime)):e._panner.setOrientation(e._orientation[0],e._orientation[1],e._orientation[2])):(e._panner=Howler.ctx.createStereoPanner(),e._panner.pan.setValueAtTime(e._stereo,Howler.ctx.currentTime)),e._panner.connect(e._node),e._paused||e._parent.pause(e._id,!0).play(e._id,!0)}}()}},t={};function n(i){var o=t[i];if(void 0!==o)return o.exports;var s=t[i]={exports:{}};return e[i](s,s.exports,n),s.exports}n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),function(){"use strict";var e=n(766);const t={knight:{Idle:{row:1,num_rows:1,frames:10,max_frames:10,left_offset:40,right_offset:40,left_pos_offset:-60,right_pos_offset:-20,top_offset_multiplier:1.9},lAttack:{row:1,num_rows:1,frames:10,max_frames:10,left_offset:-20,right_offset:0,left_pos_offset:-260,right_pos_offset:-120,top_offset_multiplier:1.9},hAttack:{row:1,num_rows:1,frames:6,max_frames:6,left_offset:20,right_offset:20,left_pos_offset:0,right_pos_offset:0,top_offset_multiplier:1.9},jump:{row:1,num_rows:1,frames:3,max_frames:3,left_offset:20,right_offset:20,pos_offset:0,left_pos_offset:-130,right_pos_offset:-100,top_offset_multiplier:1.9},jumpFallinbetween:{row:1,num_rows:1,frames:2,max_frames:2,left_offset:20,right_offset:20,left_pos_offset:0,right_pos_offset:0,top_offset_multiplier:1.9},Run:{row:1,num_rows:1,frames:10,max_frames:10,left_offset:40,right_offset:40,left_pos_offset:-40,right_pos_offset:-40,top_offset_multiplier:1.9},hit:{row:1,num_rows:1,frames:1,max_frames:1,left_offset:0,right_offset:0,left_pos_offset:-120,right_pos_offset:-80,top_offset_multiplier:1.9},death:{row:1,num_rows:1,frames:10,max_frames:10,left_offset:0,right_offset:0,left_pos_offset:-260,right_pos_offset:-120,top_offset_multiplier:1.9}},skeleton:{Idle:{row:4,num_rows:5,frames:4,max_frames:13,left_offset:0,right_offset:0,left_pos_offset:-80,right_pos_offset:-80,top_offset_multiplier:1.8},lAttack:{row:1,num_rows:5,frames:13,max_frames:13,left_offset:0,right_offset:0,left_pos_offset:-80,right_pos_offset:-80,top_offset_multiplier:4.6},death:{row:2,num_rows:5,frames:13,max_frames:13,left_offset:0,right_offset:0,left_pos_offset:-80,right_pos_offset:-80,top_offset_multiplier:1.7},hit:{row:2,num_rows:5,frames:3,max_frames:13,left_offset:0,right_offset:0,left_pos_offset:-80,right_pos_offset:-80,top_offset_multiplier:1.65},Run:{row:3,num_rows:5,frames:12,max_frames:13,left_offset:0,right_offset:0,left_pos_offset:-80,right_pos_offset:-80,top_offset_multiplier:1.35}}},i={lightning:{typeA:{row:1,num_rows:2,frames:6,max_frames:6,left_offset:0,right_offset:0,left_pos_offset:0,right_pos_offset:0,top_offset_multiplier:0},typeB:{row:2,num_rows:2,frames:6,max_frames:6,left_offset:0,right_offset:0,left_pos_offset:0,right_pos_offset:0,top_offset_multiplier:0}}};class o{constructor(e,t,n){this.ctx=e,this.dimensions=t,this.owner=n,this.health=100}reduceHealth(e){this.health-=e,this.health<0&&(this.health=0)}increaseHealth(e){}drawLifebar(){"knight"===this.owner.model?(this.ctx.fillStyle="yellow",this.ctx.fillRect(10,20,this.dimensions.width/2-120,30),this.ctx.fillStyle="red",this.ctx.fillRect(10,20,(100-this.health)/100*(this.dimensions.width/2-120),30),this.ctx.font="25px Sans-serif",this.ctx.fillStyle="black",this.ctx.lineWidth=2,this.ctx.fillText("Player Health",100,42)):(this.ctx.fillStyle="yellow",this.ctx.fillRect(this.owner.position[0]-10,this.owner.position[1]-20,this.owner.size.width+20,5),this.ctx.fillStyle="red",this.ctx.fillRect(this.owner.position[0]-10,this.owner.position[1]-20,(100-this.health)/100*(this.owner.size.width+20),5))}}class s{constructor(e,t,n,i="left",s={height:110,width:40},r=[],a=[]){this.game=e,this.model=n,this.currentAnimation="Idle",this.size=s,this.lifebar=new o(this.game.ctx,this.game.dimensions,this),this.position=t,this.stunned=!1,this.currentAction=null,this.hitbox=[],this.directionFaced=i,this.framesDrawn=0,this.currentFrame=0,this.xVel=0,this.yVel=0}resetCurrentFrame(){let e=t[`${this.model}`][`${this.currentAnimation}`];this.comboWindowOpen&&0!==this.currentFrame||(this.currentFrame="right"===this.directionFaced?0:e.max_frames-1)}setCurrentAnimation(){this.currentAction?this.currentAnimation=this.currentAction:0===this.xVel&&0===this.yVel?this.currentAnimation="Idle":this.currentAnimation="Run"}drawCharacter(){this.setCurrentAnimation();let e=new Image,n=t[`${this.model}`][`${this.currentAnimation}`];this.currentFrame=this.currentFrame%n.frames,e.onload=()=>{let t,i=e.width/n.max_frames,o=e.height/n.num_rows;t="left"===this.directionFaced?this.currentFrame*i+(n.max_frames-n.frames)*i+n[`${this.directionFaced}_offset`]:this.currentFrame*i+n[`${this.directionFaced}_offset`];let s=o*n.row/n.top_offset_multiplier;this.game.ctx.drawImage(e,t,s,i,o,this.position[0]+n[`${this.directionFaced}_pos_offset`],this.position[1],3*i,3*o)},"knight"===this.model?e.src=`./images/${this.model}/${this.currentAnimation}_${this.directionFaced}.png`:e.src=`./images/${this.model}/${this.model}_${this.directionFaced}.png`,this.framesDrawn++,this.framesDrawn>=10&&("death"===this.currentAction||"hit"===this.currentAction?"right"===this.directionFaced?this.currentFrame!==n.frames-1&&this.currentFrame++:this.currentFrame!==n.max_frames-n.frames&&this.currentFrame--:("right"===this.directionFaced?this.currentFrame++:this.currentFrame--,this.currentFrame<0&&(this.currentFrame=n.frames-1)),this.framesDrawn=0)}move(){console.log("fell to super class move")}takeDamage(e){"death"===this.currentAnimation||this.iFrames||(this.getHitSound(),this.lifebar.reduceHealth(e),this.stunned=!0,this.currentFrame=0,this.resetCurrentFrame(),this.currentAction="hit",setTimeout((()=>{"death"!==this.currentAction&&(this.currentAction=null)}),500),setTimeout((()=>this.stunned=!1),800),"knight"===this.model&&(this.iFrames=!0,setTimeout((()=>this.iFrames=!1),1500),this.game.currentScreen.startFlashScreen()))}death(){this.getDeathSound(),this.currentFrame=0,this.resetCurrentFrame(),this.stunned=!0,this.currentAction="death"}performLightAttack(){"right"===this.directionFaced?this.hitbox=[this.position[0],this.position[1]+this.size.height,this.position[0]+185,this.position[1]]:this.hitbox=[this.position[0]-175,this.position[1]+this.size.height,this.position[0],this.position[1]],this.currentAction="lAttack",this.comboWindowOpen=!0,setTimeout((()=>{this.comboWindowOpen=!1,this.hitbox=[],this.currentAction=null}),500)}performHeavyAttack(){}performThrow(){}calculateHurtBox(){return[this.position[0],this.position[1]+this.size.height,this.position[0]+this.size.width,this.position[1]]}checkXInbounds(e){return e<this.game.currentScreen.dimensions.width-20&&e>0}checkYInbounds(e){return e>this.game.currentScreen.floorHeight-50&&e<this.game.currentScreen.dimensions.height-80}}class r{constructor(){this.controls={up:"KeyW",down:"KeyS",left:"KeyA",right:"KeyD",lAttack:"KeyJ",hAttack:"KeyK",throw:"KeyL",jump:"Space"},this.difficulty="easy",this.stage="random",this.sound="on"}}class a extends s{constructor(e){super(e,[30,450],"knight","right",{height:110,width:40}),this.blockGuage=100,this.blockStatus=!1,this.score=0,this.jumpVel=0,this.jumpHeight=0,this.moveLockOut=!1,this.moveSpeed=1}HIT_SOUNDS=["./sounds/player_sounds/hit/pain1.wav","./sounds/player_sounds/hit/pain2.wav","./sounds/player_sounds/hit/pain3.wav"];ATTACK_SOUNDS=["./sounds/player_sounds/lAttack/hammer-1a.wav","./sounds/player_sounds/lAttack/hammer-1b.wav","./sounds/player_sounds/lAttack/sword-arm-2a.wav","./sounds/player_sounds/lAttack/sword-arm-2b.wav"];RUN_SOUNDS=["./sounds/player_sounds/move/step_metal1.ogg","./sounds/player_sounds/move/step_metal2.ogg","./sounds/player_sounds/move/step_metal3.ogg","./sounds/player_sounds/move/step_metal4.ogg"];lockOutMove(){this.moveLockOut=!0,setTimeout((()=>this.moveLockOut=!1),50)}move(){"jump"===this.currentAction||"death"===this.currentAnimation||this.stunned||(!this.game.controller.up&&this.yVel<0&&(this.yVel+=this.moveSpeed),!this.game.controller.down&&this.yVel>0&&(this.yVel-=this.moveSpeed),!this.game.controller.left&&this.xVel<0&&(this.xVel+=this.moveSpeed),!this.game.controller.right&&this.xVel>0&&(this.xVel-=this.moveSpeed),this.moveLockOut||(this.game.controller.up&&(!this.game.controller.down&&this.yVel>0&&(this.yVel=0),this.dashDirection=null,this.yVel>-5&&(this.yVel-=this.moveSpeed)),this.game.controller.down&&(!this.game.controller.up&&this.yVel<0&&(this.yVel=0),this.dashDirection=null,this.yVel<5&&(this.yVel+=this.moveSpeed)),this.game.controller.left&&(!this.game.controller.right&&this.xVel>0&&(this.xVel=0),"right"===this.dashDirection&&this.dashDirection,(this.xVel>-5||"left"===this.dashDirection&&this.xVel>-15)&&(this.xVel-=this.moveSpeed)),this.game.controller.right&&(!this.game.controller.left&&this.xVel<0&&(this.xVel=0),"left"===this.dashDirection&&this.dashDirection,(this.xVel<5||"right"===this.dashDirection&&this.xVel<15)&&(this.xVel+=this.moveSpeed)))),this.updateNewPos(),this.lockOutMove()}performAction(e){this.currentAction||(e.lAttack?(this.getAttackSound(),this.performLightAttack()):e.hAttack?this.performHeavyAttack():e.jump?this.jump():e.throw&&this.performThrow())}updateNewPos(){let e=this.position.slice();this.stunned&&(this.xVel=0,this.yVel=0),this.checkXInbounds(this.position[0]+this.xVel)&&(this.position[0]+=this.xVel),"jump"!==this.currentAction?(this.checkYInbounds(this.position[1]+this.yVel)&&(this.position[1]+=this.yVel),e[0]===this.position[0]&&e[1]===this.position[1]||this.getRunSound()):(this.yVel<0?(this.position[1]+=this.yVel,this.jumpHeight-=this.yVel,this.yVel+=2.5):this.jumpHeight-this.yVel<0?(this.position[1]+=this.jumpHeight,this.jumpHeight=0,this.yVel=0,this.xVel=0):(this.position[1]+=this.yVel,this.jumpHeight-=this.yVel,this.yVel+=2.5),0===this.yVel&&0===this.jumpHeight&&(this.currentAction=null));let t=this.directionFaced;this.xVel>0&&(this.directionFaced="right"),this.xVel<0&&(this.directionFaced="left"),t!==this.directionFaced&&this.resetCurrentFrame()}jump(){this.currentAction="jump",this.yVel-=40,this.game.controller.left&&!this.game.controller.right&&(this.xVel=-10),this.game.controller.right&&!this.game.controller.left&&(this.xVel=10)}dash(e){this.dashDirection=e}getRunSound(){this.runSoundTimeOut||(this.runSoundTimeOut=!0,setTimeout((()=>this.runSoundTimeOut=!1),700),"on"===this.game.options.sound&&new Howl({src:["./sounds/player_sounds/move/steps_platform.ogg"]}).play())}getAttackSound(){this.currentAttackSound||(this.currentAttackSound=0),"on"===this.game.options.sound&&new Howl({src:[this.ATTACK_SOUNDS[this.currentAttackSound]]}).play(),this.currentAttackSound++,this.currentAttackSound=this.currentAttackSound%this.ATTACK_SOUNDS.length}getHitSound(){this.currentHitSound||(this.currentHitSound=0),"on"===this.game.options.sound&&new Howl({src:[this.HIT_SOUNDS[this.currentHitSound]]}).play(),this.currentHitSound++,this.currentHitSound=this.currentHitSound%this.ATTACK_SOUNDS.length}getDeathSound(){"on"===this.game.options.sound&&new Howl({src:["./sounds/player_sounds/death/die2.wav"]}).play()}}class d{constructor(e,t,n,i=!1){this.optionText=e,this.selectedStatus=i,this.selectedAction=n,this.position=t}draw(e){e.fillStyle=this.selectedStatus?"yellow":"red",e.font="30px Comic Sans MS",e.fillText(`${this.optionText}`,this.position[0],this.position[1])}toggleHighlight(){!0===this.selectedStatus?this.selectedStatus=!1:this.selectedStatus=!0}}class u{constructor(e){this.game=e,this.dimensions=e.dimensions,this.ctx=e.ctx,this.createMainMenuOptions(),this.menuReady=!1,setTimeout((()=>this.menuReady=!0),1e3),this.lightningReady=!0,this.framesDrawn=0,this.currentFrame=0,this.startMusic()}move(e){this.menuReady&&(e.up&&(this.menuOptions[this.selectedIdx].toggleHighlight(),this.selectedIdx--,this.selectedIdx<0&&(this.selectedIdx=this.menuOptions.length-1),this.menuOptions[this.selectedIdx].toggleHighlight(),this.lockoutMenu()),e.down&&(this.menuOptions[this.selectedIdx].toggleHighlight(),this.selectedIdx++,this.selectedIdx===this.menuOptions.length&&(this.selectedIdx=0),this.menuOptions[this.selectedIdx].toggleHighlight(),this.lockoutMenu()),e.left,e.right)}performAction(e){this.menuReady&&e.lAttack&&(this.menuOptions[this.selectedIdx].selectedAction(),this.menuReady=!1,this.lockoutMenu())}playMenuMoveSound(){"on"===this.game.options.sound&&new e.Howl({src:["./sounds/menu_sounds/MENU_Pick.wav"]}).play()}lockoutMenu(){this.menuReady=!1,this.playMenuMoveSound(),setTimeout((()=>this.menuReady=!0),200)}createMainMenuOptions(){this.lockoutMenu(),this.headline="Beat-Em-Up",this.selectedIdx=0;const e=new d("Start",[this.dimensions.width/2,this.dimensions.height/2],this.startGame.bind(this),!0),t=new d("Options",[this.dimensions.width/2,this.dimensions.height/1.6],this.createOptionsMenuOptions.bind(this));this.menuOptions=[e,t]}createOptionsMenuOptions(){this.lockoutMenu(),this.headline="Options",this.selectedIdx=0;const e=new d("Sound",[this.dimensions.width/2,this.dimensions.height/1.85],this.createSoundMenuOptions.bind(this),!0),t=new d("Difficulty",[this.dimensions.width/2,this.dimensions.height/1.6],this.createDifficultyMenuOptions.bind(this)),n=new d("Change Controls",[this.dimensions.width/2,this.dimensions.height/1.4],this.createControlsMenuOptions.bind(this)),i=new d("Back",[this.dimensions.width/2,this.dimensions.height/1.2],this.createMainMenuOptions.bind(this));this.menuOptions=[e,t,n,i]}createControlsMenuOptions(){this.lockoutMenu(),this.headline="Controls",this.selectedIdx=0,this.menuOptions=[new d("Reset Default",[this.dimensions.width/2,this.dimensions.height/3],this.updateControls,!0),new d(`Up: ${this.game.options.controls.up}`,[this.dimensions.width/2,this.dimensions.height/2.5],this.updateControls),new d(`Down: ${this.game.options.controls.down}`,[this.dimensions.width/2,this.dimensions.height/2.2],this.updateControls),new d(`Left: ${this.game.options.controls.left}`,[this.dimensions.width/2,this.dimensions.height/1.95],this.updateControls),new d(`Right: ${this.game.options.controls.right}`,[this.dimensions.width/2,this.dimensions.height/1.75],this.updateControls),new d(`Light Attack: ${this.game.options.controls.lAttack}`,[this.dimensions.width/2,this.dimensions.height/1.59],this.updateControls),new d(`Heavy Attack: ${this.game.options.controls.hAttack}`,[this.dimensions.width/2,this.dimensions.height/1.46],this.updateControls),new d(`Block: ${this.game.options.controls.block}`,[this.dimensions.width/2,this.dimensions.height/1.35],this.updateControls),new d(`Throw/Pick Up Item: ${this.game.options.controls.throw}`,[this.dimensions.width/2,this.dimensions.height/1.26],this.updateControls),new d("Confirm Changes",[this.dimensions.width/2,this.dimensions.height/1.1],this.updateControls),new d("Back",[this.dimensions.width/2,this.dimensions.height/1.04],this.createOptionsMenuOptions.bind(this))]}createDifficultyMenuOptions(){this.lockoutMenu(),this.headline="Difficulty",this.menuOptions=[new d("Easy",[this.dimensions.width/2,this.dimensions.height/1.85],(()=>this.adjustDifficulty("easy")),"easy"===this.game.options.difficulty),new d("Medium",[this.dimensions.width/2,this.dimensions.height/1.6],(()=>this.adjustDifficulty("medium")),"medium"===this.game.options.difficulty),new d("Hard",[this.dimensions.width/2,this.dimensions.height/1.4],(()=>this.adjustDifficulty("hard")),"hard"===this.game.options.difficulty)],this.menuOptions.forEach(((e,t)=>{e.selectedStatus&&(this.selectedIdx=t)}))}createSoundMenuOptions(){this.lockoutMenu(),this.headline="Sound",this.menuOptions=[new d("On",[this.dimensions.width/2,this.dimensions.height/1.85],(()=>this.adjustSound("on")),"on"===this.game.options.sound),new d("Off",[this.dimensions.width/2,this.dimensions.height/1.6],(()=>this.adjustSound("off")),"off"===this.game.options.sound)],this.menuOptions.forEach(((e,t)=>{e.selectedStatus&&(this.selectedIdx=t)}))}draw(e){var t=new Image;if(t.onload=()=>{this.ctx.drawImage(t,0,0,this.dimensions.width,this.dimensions.height)},t.src="./images/gameBackgrounds/titleMenubackground.jpg",console.log(this.lightningReady),this.lightningReady){const e=i.lightning[this.getRandomType()],t=new Image;t.onload=()=>{let n=t.height/e.num_rows,i=t.width/e.max_frames,o=i*this.currentFrame,s=n*e.row;this.currentLightningPos||(this.currentLightningPos=this.getrandomLightningPos()),this.ctx.drawImage(t,o,s,i,n,this.currentLightningPos,0,3*i,3*n),this.framesDrawn++,4===this.framesDrawn&&(this.currentFrame++,this.currentFrame>e.max_frames&&(this.lightningReady=!1,this.currentLightningPos=null,this.startLightningTimeout()),this.framesDrawn=0)},t.src="./images/lightning/lightning.png"}e.font="50px Comic Sans MS",e.fillStyle="red",e.textAlign="center",e.fillText(`${this.headline}`,this.dimensions.width/2,this.dimensions.height/5),this.menuOptions.forEach((t=>t.draw(e)))}startGame(){this.stopMusic(),this.game.startGame()}adjustControls(){}adjustDifficulty(e){this.game.options.difficulty=e,this.createOptionsMenuOptions()}adjustSound(e){this.game.options.sound=e,this.createOptionsMenuOptions()}startLightningTimeout(){setTimeout((()=>{this.lightningReady=!0,this.currentFrame=0}),3e3*Math.random())}getRandomType(){return 0===Math.floor(2*Math.random())?"typeA":"typeB"}getrandomLightningPos(){return Math.floor(Math.random()*this.dimensions.width)}startMusic(){"on"===this.game.options.sound&&(this.sound=new e.Howl({src:["./sounds/Searching.ogg"]}),this.sound.play())}stopMusic(){this.sound.stop()}}class h{constructor(e){this.game=e,this.ctx=this.game.ctx,this.dimensions=this.game.dimensions,this.continueDelay=100,this.optionSelected="Yes",this.score=this.game.currentScreen.score,this.score.timer.stopTimer(),this.moveLockout=!0,setTimeout((()=>this.moveLockout=!1),1e3)}draw(){this.ctx.globalAlpha=.5,this.ctx.fillStyle="gray",this.ctx.fillRect(0,0,this.dimensions.width,this.dimensions.height),this.ctx.globalAlpha=1,this.ctx.font="100px Sans-serif",this.ctx.strokeStyle="black",this.ctx.lineWidth=8,this.ctx.fillStyle="red",this.ctx.strokeText("Game Over",this.dimensions.width/2,this.dimensions.height/2-100),this.ctx.fillText("Game Over",this.dimensions.width/2,this.dimensions.height/2-100),this.ctx.fillStyle="yellow",this.ctx.font="60px Sans-serif",this.ctx.strokeText("Retry?",this.dimensions.width/2,this.dimensions.height/2+100),this.ctx.fillText("Retry?",this.dimensions.width/2,this.dimensions.height/2+100),this.ctx.font="40px Sans-serif",this.ctx.fillStyle="Yes"===this.optionSelected?"yellow":"red",this.ctx.strokeText("Yes",this.dimensions.width/2-50,this.dimensions.height-60),this.ctx.fillText("Yes",this.dimensions.width/2-50,this.dimensions.height-60),this.ctx.fillStyle="No"===this.optionSelected?"yellow":"red",this.ctx.strokeText("No",this.dimensions.width/2+50,this.dimensions.height-60),this.ctx.fillText("No",this.dimensions.width/2+50,this.dimensions.height-60)}move(e){this.moveLockout||(e.left||e.right)&&(this.optionSelected="Yes"===this.optionSelected?"No":"Yes",this.playSound(),this.moveLockout=!0,setTimeout((()=>this.moveLockout=!1),200))}performAction(e){this.moveLockout||e.lAttack&&("Yes"===this.optionSelected?(this.playSound(),this.game.currentScreen=new p(this.game)):(this.playSound(),this.game.currentScreen.stopMusic(),this.game.currentScreen=new u(this.game)))}playSound(){"on"===this.game.options.sound&&new Howl({src:["./sounds/menu_sounds/MENU_Pick.wav"]}).play()}}class l extends s{constructor(e,t,n="skeleton",i=50){super(e,t,n,1===Math.floor(2*Math.random())?"left":"right"),this.hitBoxRange=[175,50],this.agressionRating=this.getAggressionRating(),this.ActionLockOut=!1,this.scoreBase=i}getAggressionRating(){if("easy"===this.game.options.difficulty)return 10}determineNextAction(){this.stunned||this.ActionLockOut||(this.checkXInbounds(this.position[0])&&this.isPlayerInRange()?this.getRandomInRangeAction():this.move())}facePlayer(){this.game.currentScreen.player.position[0]<this.position[0]?this.directionFaced="left":this.directionFaced="right"}isPlayerInRange(){let e=this.game.currentScreen.player.position;return Math.abs(this.position[0]-e[0])<this.hitBoxRange[0]&&Math.abs(this.position[1]-e[1])<this.hitBoxRange[1]&&"jump"!==this.game.currentScreen.player.currentAction}getRandomInRangeAction(){100*Math.random()<this.agressionRating&&this.performLightAttack()}move(){this.facePlayer(),this.checkXInbounds(this.position[0])?(this.xVel=Math.floor(Math.random())+1,this.yVel=Math.floor(2*Math.random()),"left"===this.directionFaced&&(this.xVel=-this.xVel),this.position[1]>this.game.currentScreen.player.position[1]&&(this.yVel=-this.yVel)):this.xVel="left"===this.directionFaced?-2:2,this.updateCurrentPos()}updateCurrentPos(){this.position[0]+=this.xVel,this.position[1]+=this.yVel}lockOutAction(){this.ActionLockOut=!0,this.xVel=0,this.yVel=0,setTimeout((()=>this.ActionLockOut=!1),500)}posture(){}getAttackTimeOut(){}performAction(){}getHitSound(){}getDeathSound(){}}class c{constructor(e,t,n){this.timer=n,this.dimensions=t,this.ctx=e,this.score=0}increaseScore(e){let t=1+Math.floor(this.timer.time/20);this.score+=e.scoreBase*t}draw(){this.ctx.font="40px Sans-serif",this.ctx.strokeStyle="black",this.ctx.lineWidth=8,this.ctx.fillStyle="yellow",this.ctx.strokeText("SCORE",this.dimensions.width/1.4,40),this.ctx.fillText("SCORE",this.dimensions.width/1.4,40),this.ctx.font="40px Sans-serif",this.ctx.strokeText(this.score,this.dimensions.width/1.1,40),this.ctx.fillText(this.score,this.dimensions.width/1.1,40)}}class _{constructor(e,t){this.ctx=e,this.dimensions=t,this.time=0,this.counter=this.startTimer()}startTimer(){return setInterval((()=>this.time+=1),1e3)}stopTimer(){clearInterval(this.counter)}draw(){this.ctx.font="40px Sans-serif",this.ctx.strokeStyle="black",this.ctx.lineWidth=8,this.ctx.fillStyle="yellow",this.ctx.strokeText("TIME",this.dimensions.width/2-10,40),this.ctx.fillText("TIME",this.dimensions.width/2-10,40),this.ctx.font="60px Sans-serif",this.ctx.strokeText(this.time,this.dimensions.width/2-10,100),this.ctx.fillText(this.time,this.dimensions.width/2-10,100)}}class p{constructor(e){this.game=e,this.dimensions=e.dimensions,this.floorHeight=e.dimensions.height/2.2,this.ctx=e.ctx,this.enemies=[],this.killed_characters=[],this.player=new a(e),this.timer=new _(this.ctx,this.dimensions),this.score=new c(this.ctx,this.dimensions,this.timer),this.addNewEnemies(),this.startMusic(),this.gameOver=!1}startMusic(){"on"===this.game.options.sound&&(this.sound=new Howl({src:["./sounds/The_Dark_Amulet.mp3"]}),this.sound.play())}stopMusic(){this.sound.stop()}draw(){if(this.flashScreen)this.ctx.fillStyle="white",this.ctx.fillRect(0,0,this.dimensions.width,this.dimensions.height),this.flashScreen=!1;else{var e=new Image;e.onload=()=>{this.ctx.drawImage(e,0,0,this.dimensions.width,this.dimensions.height)},e.src="./images/gameBackgrounds/stageBackground.png",this.player.drawCharacter(),this.player.lifebar.drawLifebar(),this.timer.draw(),this.score.draw(),this.enemies.forEach((e=>{e.drawCharacter(),e.lifebar.drawLifebar()})),this.killed_characters.forEach((e=>{e.drawCharacter(),e.lifebar.drawLifebar()})),this.gameOver&&(this.continueScreen||(this.continueScreen=new h(this.game)),this.continueScreen.draw())}}move(e){this.gameOver?(this.continueScreen||(this.continueScreen=new h(this.game)),this.continueScreen.move(e)):this.player.move(e)}performAction(e){this.gameOver?(this.continueScreen||(this.continueScreen=new h(this.game)),this.continueScreen.performAction(e)):this.player.performAction(e)}addNewEnemies(){let e=2+Math.floor(this.timer.time/20);for(;this.enemies.length<e;)this.generateEnemy()}generateEnemy(){let e=new l(this.game,this.getRandomStartPos());this.enemies.push(e)}getRandomStartPos(){return["left"==(1===Math.floor(2*Math.random())?"left":"right")?1e3:-100,Math.floor(Math.random()*(this.dimensions.height-this.floorHeight))+this.floorHeight]}checkAttacksLanded(){this.checkPlayerAttacks(),this.checkEnemyAttack()}checkKilledEnemies(){this.enemies.forEach(((e,t)=>{0===e.lifebar.health&&(this.enemies=this.enemies.slice(0,t).concat(this.enemies.slice(t+1)),this.killed_characters.push(e),setTimeout((()=>this.killed_characters.shift()),5e3),e.death(),this.score.increaseScore(e))}))}checkKilledPlayer(){0===this.player.lifebar.health&&"death"!==this.player.currentAction&&(this.killed_characters.push(this.player),setTimeout((()=>this.killed_characters.shift()),5e3),this.player.death(),this.gameOver=!0)}checkPlayerAttacks(){this.player.hitbox.length&&this.enemies.forEach((e=>{if(this.checkCollision(this.player.hitbox,e.calculateHurtBox()))switch(this.player.currentAction){case"lAttack":e.stunned||e.takeDamage(15);break;case"hAttack":e.takeDamage(30);break;case"throw":e.takeDamage(50)}}))}checkEnemyAttack(){this.enemies.forEach((e=>{this.checkCollision(e.hitbox,this.player.calculateHurtBox())&&(this.player.stunned||this.player.takeDamage(10))}))}checkCollision(e,t){return(e[0]<=t[0]&&e[2]>=t[0]||e[0]<=t[2]&&e[2]>=t[2])&&(e[1]>=t[1]&&e[3]<=t[1]||e[1]>=t[3]&&e[3]<=t[3])}startFlashScreen(){this.flashScreen=!0}}class m{constructor(e){this.ctx=e.getContext("2d"),this.dimensions={width:e.width,height:e.height},this.options=new r,this.startMenu(),this.controller={up:!1,down:!1,left:!1,right:!1,lAttack:!1,hAttack:!1,jump:!1,throw:!1},this.update(),this.ctx.webkitImageSmoothingEnabled=!1,this.ctx.imageSmoothingEnabled=!1}startMenu(){this.currentScreen=new u(this)}startGame(){this.currentScreen=new p(this)}startDashTimeOut(){this.dashTimeOut=setTimeout((()=>{this.dashWindow=null}),2e3)}setKeyDown(e){"left"!==e&&"right"!==e||(this.dashWindow&&this.dashWindow.direction===e?this.dashWindow.numUp>0&&this.dashWindow.numDown++:(this.dashWindow={numDown:1,numUp:0,direction:e},this.startDashTimeOut())),this.controller[`${e}`]=!0}setKeyUp(e){"left"!==e&&"right"!==e||this.dashWindow&&this.dashWindow.direction===e&&(this.dashWindow.numUp++,this.dashWindow.numDown>=2&&this.dashWindow.numUp>=2&&this.currentScreen.constructor===p&&(this.currentScreen.player.dash(`${e}`),this.dashTimeOut=null)),this.controller[`${e}`]=!1}checkInputs(){let e={left:this.controller.left,up:this.controller.up,right:this.controller.right,down:this.controller.down},t={lAttack:this.controller.lAttack,hAttack:this.controller.hAttack,jump:this.controller.jump,throw:this.controller.throw};this.currentScreen.move(e),this.currentScreen.performAction(t)}update(){this.currentScreen.draw(this.ctx),this.checkInputs(),this.currentScreen.constructor===p&&(this.currentScreen.checkAttacksLanded(),this.currentScreen.checkKilledEnemies(),this.currentScreen.checkKilledPlayer(),this.currentScreen.addNewEnemies(),this.currentScreen.enemies.forEach((e=>e.determineNextAction()))),requestAnimationFrame(this.update.bind(this))}}document.addEventListener("DOMContentLoaded",(()=>{let e,t=document.querySelector(".background-container"),n=document.querySelector("#enter-checkbox"),i=document.createElement("img"),o=document.createElement("img"),s=document.createElement("img"),r=document.createElement("div");i.setAttribute("src","./images/mainPage/neon_enter_sign.gif"),o.setAttribute("src","./images/mainPage/neon_click_here.gif"),s.setAttribute("src","./images/mainPage/arcadeSign.gif"),i.classList.add("enter-sign"),s.classList.add("arcade-open-sign"),o.classList.add("click-here-sign"),r.classList.add("click-container"),t.appendChild(s),r.appendChild(i),r.appendChild(o),t.appendChild(r),r.addEventListener("click",(a=>{r.style.display="none",o.style.display="none",i.style.display="none",s.style.display="none",n.checked=!0,setTimeout((()=>{t.style.backgroundImage="url('./images/mainPage/arcade_screen_background.jpg')",t.style.backgroundSize="contain",document.querySelector(".canvas-container").style.display="flex";let i=document.getElementById("game-canvas");e=new m(i),n.checked=!1,document.addEventListener("keydown",(t=>{let n=Object.keys(e.options.controls).filter((n=>e.options.controls[n]===t.code));n.length&&e.setKeyDown(n[0])})),document.addEventListener("keyup",(t=>{let n=Object.keys(e.options.controls).filter((n=>e.options.controls[n]===t.code));n.length&&e.setKeyUp(n[0])}))}),5e3)}))}))}()}();
//# sourceMappingURL=main.js.map